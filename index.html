<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <title>GamesTec - Ofertas Oficiais Shopee</title>
    <meta property="og:title" content="GamesTec - Eletrônicos e Ferramentas">
    <meta property="og:description" content="Patrocinador Oficial Shopee. Ofertas limitadas com entrega garantida pelos Correios.">
    <meta property="og:image" content="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQIMpDrXweRZaklOP0jBTEiMCqO_irN0Kbq5Og30rjLpa_5tqSVse3owjI&s=10">
    <meta property="og:image:width" content="500">
    <meta property="og:image:height" content="500">
    <link rel="icon" href="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQIMpDrXweRZaklOP0jBTEiMCqO_irN0Kbq5Og30rjLpa_5tqSVse3owjI&s=10" type="image/x-icon">

    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary: #ff5000; /* Laranja estilo Shopee */
            --secondary: #ff0033; 
            --dark: #222;
            --light: #f5f5f5;
            --white: #fff;
            --gray: #999;
            --border: #e5e5e5;
            --success: #00bfa5;
            --blue-correios: #00416B;
            --yellow-correios: #FDD000;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Roboto', sans-serif; -webkit-tap-highlight-color: transparent; }
        
        body { background-color: var(--light); color: var(--dark); padding-bottom: 60px; overflow-x: hidden; height: 100vh; }

        /* Utilitários */
        .hidden { display: none !important; }
        .flex { display: flex; }
        .center { display: flex; justify-content: center; align-items: center; }
        .col { flex-direction: column; }
        .text-primary { color: var(--primary); }
        .strike { text-decoration: line-through; color: var(--gray); font-size: 0.8rem; }
        .price-tag { font-size: 1.2rem; font-weight: 900; color: var(--primary); }
        .btn { border: none; padding: 12px 20px; border-radius: 4px; font-weight: bold; cursor: pointer; transition: 0.2s; width: 100%; text-align: center; }
        .btn-primary { background: linear-gradient(to right, #ff9000, #ff5000); color: white; }
        .btn-secondary { background: white; border: 1px solid var(--border); color: var(--dark); }
        .btn-correios { background: var(--blue-correios); color: var(--yellow-correios); font-weight: 900; }
        .container { max-width: 1200px; margin: 0 auto; padding: 10px; }

        /* Branding Shopee Oficial */
        .official-sponsor {
            background: #fff;
            padding: 5px 10px;
            font-size: 0.7rem;
            color: #555;
            display: flex;
            align-items: center;
            justify-content: center;
            border-bottom: 1px solid #eee;
        }
        .shopee-badge {
            height: 18px;
            margin-right: 5px;
        }

        /* Header */
        header { background: var(--white); position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .top-bar { padding: 10px; display: flex; justify-content: space-between; align-items: center; background: var(--primary); color: white; font-size: 0.8rem; }
        .main-header { padding: 10px; display: flex; align-items: center; gap: 10px; }
        
        .logo-area { display: flex; align-items: center; gap: 5px; cursor: pointer; }
        .logo-img { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; border: 2px solid var(--primary); }
        .logo-text { font-size: 1.4rem; font-weight: 900; color: var(--primary); letter-spacing: -1px; }
        
        .search-bar { flex: 1; position: relative; }
        .search-bar input { width: 100%; padding: 8px 35px 8px 10px; border: 1px solid var(--primary); border-radius: 4px; background: #f0f0f0; }
        .search-icon { position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: var(--primary); }

        /* Categorias */
        .categories-scroll { display: flex; overflow-x: auto; padding: 10px; gap: 15px; background: white; scrollbar-width: none; }
        .cat-item { display: flex; flex-direction: column; align-items: center; min-width: 60px; font-size: 0.75rem; color: #555; cursor: pointer; }
        .cat-item:hover .cat-img { border: 2px solid var(--primary); }
        .cat-img { width: 40px; height: 40px; background: #eee; border-radius: 50%; margin-bottom: 5px; display: flex; justify-content: center; align-items: center; font-size: 1.2rem; color: var(--primary); transition: 0.2s; }

        /* Banners */
        .hero-banner { background: var(--secondary); color: white; padding: 15px; border-radius: 8px; margin: 10px; text-align: center; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.9; } 100% { opacity: 1; } }
        
        /* Grid de Produtos */
        .section-title { padding: 15px 10px 5px; font-weight: 800; display: flex; justify-content: space-between; align-items: center; }
        .timer-badge { background: black; color: white; padding: 2px 6px; border-radius: 4px; font-size: 0.8rem; margin-left: 5px; }
        
        .product-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; padding: 10px; }
        @media(min-width: 768px) { .product-grid { grid-template-columns: repeat(4, 1fr); } }

        .product-card { background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.1); cursor: pointer; transition: transform 0.2s; position: relative; }
        .product-card:hover { transform: translateY(-3px); }
        .p-img-container { width: 100%; aspect-ratio: 1/1; overflow: hidden; position: relative; }
        .p-img-container img { width: 100%; height: 100%; object-fit: cover; }
        .discount-tag { position: absolute; top: 5px; right: 5px; background: rgba(255, 230, 0, 0.9); color: black; font-weight: bold; font-size: 0.7rem; padding: 2px 5px; border-radius: 2px; }
        .p-info { padding: 8px; }
        .p-name { font-size: 0.85rem; overflow: hidden; text-overflow: ellipsis; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; height: 2.4em; margin-bottom: 5px; }
        .stars { color: #ffc107; font-size: 0.7rem; margin-bottom: 5px; }
        .sold-count { font-size: 0.7rem; color: #777; float: right; }
        
        /* Wishlist Heart Icon on Card */
        .card-heart { position: absolute; top: 5px; left: 5px; background: rgba(255,255,255,0.8); border-radius: 50%; width: 30px; height: 30px; display: flex; justify-content: center; align-items: center; color: #ccc; z-index: 10; }
        .card-heart.liked { color: var(--secondary); }

        /* Página de Produto Detalhada (CORREÇÃO DE SCROLL) */
        #product-view { 
            background: #f0f0f0; 
            height: 100%; 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            z-index: 200; 
            overflow-y: auto; 
            -webkit-overflow-scrolling: touch; 
            padding-bottom: 80px; 
        }
        
        .p-header-nav { position: absolute; top: 10px; left: 10px; z-index: 10; }
        .back-btn { background: rgba(0,0,0,0.5); color: white; width: 35px; height: 35px; border-radius: 50%; display: flex; justify-content: center; align-items: center; cursor: pointer; backdrop-filter: blur(5px); }
        .main-image { width: 100%; height: 400px; object-fit: cover; background: white; }
        .thumbs { display: flex; gap: 10px; padding: 10px; overflow-x: auto; background: white; }
        .thumb { width: 60px; height: 60px; border: 1px solid #ddd; object-fit: cover; border-radius: 4px; }
        .thumb.active { border: 2px solid var(--primary); }
        
        .p-details { padding: 15px; background: white; border-radius: 20px 20px 0 0; margin-top: -20px; position: relative; margin-bottom: 10px; min-height: 500px; }
        .shipping-info { background: #e8f7f5; padding: 10px; border-radius: 4px; margin: 15px 0; font-size: 0.85rem; display: flex; align-items: center; gap: 10px; color: #00796b; }
        
        /* Options Buttons */
        .option-btn { padding: 8px 15px; border: 1px solid #ccc; border-radius: 20px; background: white; margin-right: 8px; margin-bottom: 8px; font-size: 0.9rem; cursor: pointer; transition: 0.2s; }
        .option-btn.selected { border: 1px solid var(--primary); background: #fff0e6; color: var(--primary); font-weight: bold; }

        /* Reviews Section */
        .reviews-box { background: white; padding: 15px; margin-top: 10px; margin-bottom: 20px;}
        .review-card { border-bottom: 1px solid #eee; padding: 15px 0; }
        .review-header { display: flex; align-items: center; margin-bottom: 5px; }
        .user-avatar { width: 30px; height: 30px; background: #ddd; border-radius: 50%; margin-right: 10px; display: flex; align-items: center; justify-content: center; color: #777; font-size: 0.8rem; }
        .user-name { font-size: 0.9rem; font-weight: 500; margin-right: 10px; }
        .review-date { font-size: 0.7rem; color: #999; margin-left: auto; }
        
        /* Form de Avaliação */
        #review-form { background: #f9f9f9; padding: 15px; border-radius: 8px; margin-top: 15px; border: 1px solid #eee; }
        #review-text { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; margin-bottom: 10px; resize: vertical; }
        .star-select { font-size: 1.5rem; color: #ddd; cursor: pointer; }
        .star-select.active { color: #ffc107; }

        /* Related Products */
        .related-box { padding: 15px; padding-bottom: 100px; }
        
        /* Página de Checkout/Forms */
        .form-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 300; padding: 20px; overflow-y: auto; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: 500; font-size: 0.9rem; }
        .form-group input, .form-group select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 1rem; }
        
        /* Perfil View */
        .profile-header { background: var(--primary); color: white; padding: 30px 20px; text-align: center; border-radius: 0 0 20px 20px; margin-bottom: 20px;}
        .profile-card { background: white; padding: 15px; margin: 10px; border-radius: 8px; border: 1px solid #eee; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .history-item { display: flex; gap: 10px; margin-bottom: 10px; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        .history-img { width: 50px; height: 50px; border-radius: 4px; object-fit: cover; }
        
        /* Pagamento & Confiança */
        .payment-loader { text-align: center; margin-top: 50px; }
        .spinner { border: 4px solid #f3f3f3; border-top: 4px solid var(--primary); border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 0 auto 20px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        .trust-box { background: #f0f7ff; border: 1px solid #cce5ff; padding: 15px; border-radius: 8px; margin: 15px 0; text-align: left; }
        .trust-header { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; color: var(--blue-correios); font-weight: bold; }
        .address-confirm { background: white; padding: 10px; border: 1px dashed #ccc; font-size: 0.85rem; color: #555; margin-bottom: 10px; }
        
        .mini-map { 
            width: 100%; 
            height: 120px; 
            background-color: #e5e5f7;
            background-image:  linear-gradient(#444cf7 1px, transparent 1px), linear-gradient(90deg, #444cf7 1px, transparent 1px);
            background-size: 20px 20px;
            background-position: center;
            border-radius: 8px;
            display: flex; 
            justify-content: center; 
            align-items: center;
            color: #555;
            font-size: 0.8rem;
            position: relative;
            margin-bottom: 10px;
            overflow: hidden;
        }
        .mini-map::after {
            content: '';
            position: absolute;
            width: 100%; height: 100%;
            background: rgba(255,255,255,0.7);
        }
        .map-pin { position: absolute; z-index: 2; color: var(--primary); font-size: 2rem; animation: bounce 1s infinite; }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

        .pix-container { text-align: center; padding: 20px; background: #fff; border-radius: 8px; margin-top: 20px; border: 2px solid var(--success); position: relative; }
        .pix-badge { position: absolute; top: -12px; left: 50%; transform: translateX(-50%); background: var(--success); color: white; padding: 2px 10px; font-size: 0.75rem; border-radius: 10px; font-weight: bold; }
        .pix-code { word-break: break-all; font-family: monospace; background: #f5f5f5; padding: 10px; border: 1px solid #eee; margin: 10px 0; font-size: 0.8rem; }
        
        /* Modal +18 */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; display: flex; justify-content: center; align-items: center; padding: 20px; }
        .modal-box { background: white; padding: 30px; border-radius: 8px; text-align: center; max-width: 400px; width: 100%; box-shadow: 0 10px 25px rgba(0,0,0,0.5); }
        .modal-box h2 { color: var(--primary); margin-bottom: 15px; }
        .modal-box p { margin-bottom: 20px; color: #666; }

        /* Bottom Nav */
        .bottom-nav { position: fixed; bottom: 0; left: 0; width: 100%; background: white; border-top: 1px solid #eee; display: flex; justify-content: space-around; padding: 10px 0; z-index: 90; }
        .nav-item { text-align: center; font-size: 0.7rem; color: #999; cursor: pointer; }
        .nav-item.active { color: var(--primary); }
        .nav-item i { font-size: 1.2rem; margin-bottom: 3px; display: block; }

    </style>
</head>
<body>

<div id="age-modal" class="modal-overlay">
    <div class="modal-box">
        <i class="fas fa-user-shield fa-3x text-primary" style="margin-bottom: 15px;"></i>
        <h2>Verificação de Segurança</h2>
        <p>Bem-vindo à <strong>GamesTec</strong>, parceiro oficial Shopee. Para acessar ofertas exclusivas, confirme sua idade.</p>
        <button class="btn btn-primary" onclick="confirmAge()">SOU MAIOR DE 18 ANOS</button>
    </div>
</div>

<div id="app" class="hidden">

    <div class="official-sponsor">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/0e/Shopee_logo.svg/1200px-Shopee_logo.svg.png" class="shopee-badge" alt="Shopee">
        <span>| Loja Oficial Verificada <i class="fas fa-check-circle text-primary"></i></span>
    </div>

    <div id="home-view" class="view-section">
        <header>
            <div class="top-bar">
                <span><i class="fas fa-shield-alt"></i> Compra Garantida Shopee</span>
                <span><i class="fas fa-truck"></i> Correios Sedex</span>
            </div>
            <div class="main-header">
                <div class="logo-area" onclick="resetFilters()">
                    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQIMpDrXweRZaklOP0jBTEiMCqO_irN0Kbq5Og30rjLpa_5tqSVse3owjI&s=10" class="logo-img">
                    <span class="logo-text">GamesTec</span>
                </div>
                <div class="search-bar">
                    <input type="text" id="searchInput" placeholder="Buscar na GamesTec..." onkeyup="searchProducts(this.value)">
                    <i class="fas fa-search search-icon"></i>
                </div>
                <div style="font-size: 1.2rem; color: var(--primary); cursor: pointer;" onclick="toggleSort()">
                    <i class="fas fa-filter"></i>
                </div>
            </div>
        </header>

        <div class="categories-scroll">
            <div class="cat-item" onclick="resetFilters()"><div class="cat-img"><i class="fas fa-th-large"></i></div>Todos</div>
            <div class="cat-item" onclick="filterCategory('Acessórios')"><div class="cat-img"><i class="fas fa-glasses"></i></div>Acessórios</div>
            <div class="cat-item" onclick="filterCategory('Moda')"><div class="cat-img"><i class="fas fa-tshirt"></i></div>Roupas</div>
            <div class="cat-item" onclick="filterCategory('Eletrônicos')"><div class="cat-img"><i class="fas fa-laptop"></i></div>Eletrônicos</div>
            <div class="cat-item" onclick="filterCategory('Casa')"><div class="cat-img"><i class="fas fa-home"></i></div>Casa</div>
            <div class="cat-item" onclick="filterCategory('Brinquedos')"><div class="cat-img"><i class="fas fa-gamepad"></i></div>Brinquedos</div>
            <div class="cat-item" onclick="filterCategory('Ferramentas')"><div class="cat-img"><i class="fas fa-tools"></i></div>Ferramentas</div>
        </div>

        <div class="hero-banner">
            <h2><i class="fas fa-bolt"></i> OFERTAS SHOPEE</h2>
            <p>Preços Imbatíveis - Tempo Limitado!</p>
        </div>

        <div class="container" style="background: #fff5f0; padding: 15px; border-radius: 8px; margin: 10px; font-size: 0.9rem; border: 1px solid #ffccbc;">
            <p style="color: var(--primary); font-weight: bold;"><i class="fas fa-store"></i> Sobre a GamesTec</p>
            <p style="margin-top:5px; color: #555;">
                Distribuidor Autorizado. Conectamos você às melhores fábricas com a garantia de entrega da Shopee e Correios.
            </p>
        </div>

        <div class="section-title">
            <span id="list-title">Destaques do Dia <i class="fas fa-fire text-primary"></i></span>
            <span class="timer-badge" id="main-timer">20:00:00</span>
        </div>

        <div class="product-grid" id="product-container">
            </div>
        
        <div style="height: 60px;"></div> </div>

    <div id="wishlist-view" class="view-section hidden">
        <header>
             <div class="main-header" style="justify-content: center;">
                <div class="logo-text">Lista de Desejos</div>
             </div>
        </header>
        <div class="container">
            <div class="section-title">
                <span>Seus Favoritos</span>
            </div>
            <div id="wishlist-container" class="product-grid">
                </div>
             <div id="empty-wishlist-msg" class="hidden" style="text-align: center; padding: 50px; color: #999;">
                <i class="far fa-heart fa-3x"></i>
                <p style="margin-top: 10px;">Sua lista está vazia.</p>
                <button class="btn btn-primary" style="width: auto; margin-top: 10px;" onclick="switchTab('home')">Ir as Compras</button>
            </div>
        </div>
        <div style="height: 60px;"></div>
    </div>

    <div id="profile-view" class="view-section hidden">
        <div class="profile-header">
            <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQIMpDrXweRZaklOP0jBTEiMCqO_irN0Kbq5Og30rjLpa_5tqSVse3owjI&s=10" style="width:80px; height:80px; border-radius:50%; border:3px solid white;">
            <h2 style="margin-top: 10px;" id="profile-name-display">Visitante</h2>
            <p style="font-size:0.8rem; opacity:0.8;">Membro GamesTec</p>
        </div>
        
        <div class="container">
            <div class="profile-card">
                <h3><i class="fas fa-history text-primary"></i> Meus Pedidos</h3>
                <div id="history-container" style="margin-top: 10px;">
                    <p style="font-size: 0.9rem; color: #777;">Nenhum pedido recente.</p>
                </div>
            </div>

            <div class="profile-card">
                <h3><i class="fas fa-id-card text-primary"></i> Meus Dados</h3>
                <p style="color: #666; font-size: 0.8rem; margin-bottom: 15px;">Dados protegidos pela LGPD.</p>
                
                <div id="saved-data-display">
                    <p><strong>CPF:</strong> <span id="display-cpf">Não informado</span></p>
                    <p><strong>Endereço:</strong> <span id="display-addr">Não informado</span></p>
                    <p><strong>Número:</strong> <span id="display-num">--</span></p>
                    <p><strong>Bairro:</strong> <span id="display-bairro">--</span></p>
                    <p><strong>Cidade:</strong> <span id="display-city">--</span></p>
                </div>
                <hr style="margin: 15px 0; border: 0; border-top: 1px solid #eee;">
                <button class="btn btn-secondary" onclick="clearUserData()">Limpar Meus Dados</button>
            </div>
        </div>
        <div style="height: 60px;"></div>
    </div>

    <div id="product-view" class="hidden">
        <div class="p-header-nav">
            <div class="back-btn" onclick="goBackToHome()">
                <i class="fas fa-arrow-left"></i>
            </div>
        </div>
        
        <div id="product-content">
            </div>
    </div>

    <div id="checkout-form-view" class="form-screen hidden">
        <div class="section-title">
            <span><i class="fas fa-map-marker-alt"></i> Endereço de Entrega</span>
            <span onclick="goBackToProduct()" style="font-size: 0.8rem; color: var(--primary);">Voltar</span>
        </div>
        
        <div style="background: #e3f2fd; padding: 10px; border-radius: 4px; border: 1px solid #90caf9; margin-bottom: 15px; font-size: 0.8rem; color: #0d47a1;">
            <i class="fas fa-info-circle"></i> Seus dados são necessários para a emissão da Nota Fiscal e Garantia Shopee.
        </div>
        
        <form onsubmit="submitForm(event)">
            <div class="form-group">
                <label>Nome Completo</label>
                <input type="text" id="fname" required placeholder="Nome do destinatário">
            </div>
            <div class="form-group">
                <label>CPF (Obrigatório para Nota Fiscal)</label>
                <input type="text" id="fcpf" required placeholder="000.000.000-00">
            </div>
            <div class="form-group">
                <label>CEP</label>
                <input type="text" id="fcep" required placeholder="00000-000">
            </div>
            <div class="form-group">
                <label>Endereço (Rua, Av)</label>
                <input type="text" id="faddr" required>
            </div>
            <div class="form-group" style="display: flex; gap: 10px;">
                <div style="flex: 1;">
                    <label>Número</label>
                    <input type="text" id="fnum" required>
                </div>
                <div style="flex: 2;">
                    <label>Bairro</label>
                    <input type="text" id="fbairro" required>
                </div>
            </div>
            <div class="form-group">
                <label>Município / Estado</label>
                <input type="text" id="fcity" required>
            </div>
            <div class="form-group">
                <label>Ponto de Referência</label>
                <input type="text" id="fref">
            </div>

            <div style="background: #f0f0f0; padding: 15px; border-radius: 8px; margin: 20px 0;">
                <p><strong>Resumo do Pedido:</strong></p>
                <p id="checkout-product-name" style="font-size: 0.9rem; margin: 5px 0;">Produto...</p>
                <div id="checkout-variant" style="font-size: 0.8rem; color: #666; margin-bottom: 5px;"></div>
                <hr style="border: 0; border-top: 1px solid #ddd; margin: 10px 0;">
                <div class="flex justify-between" style="justify-content: space-between;">
                    <span>Subtotal</span>
                    <span id="checkout-subtotal">R$ --</span>
                </div>
                <div class="flex justify-between" style="justify-content: space-between; color: var(--success); font-weight: bold;">
                    <span>Frete (Shopee Xpress)</span>
                    <span>GRÁTIS</span>
                </div>
                <div class="flex justify-between" style="justify-content: space-between; margin-top: 10px; font-weight: 900; font-size: 1.1rem;">
                    <span>Total</span>
                    <span id="checkout-total">R$ --</span>
                </div>
            </div>

            <button type="submit" class="btn btn-primary">IR PARA PAGAMENTO SEGURO</button>
        </form>
    </div>

    <div id="loading-view" class="form-screen hidden center col">
        <div class="spinner"></div>
        <h3>Conectando aos Correios...</h3>
        <p>Validando endereço e estoque.</p>
    </div>

    <div id="payment-view" class="form-screen hidden">
        <div class="section-title" style="justify-content: center;">
            <span><i class="fas fa-lock"></i> Finalizar Compra</span>
        </div>
        
        <div class="trust-box">
            <div class="trust-header">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c4/Correios_%282014%29.svg/1200px-Correios_%282014%29.svg.png" width="80" alt="Correios">
                <span>Entrega Garantida</span>
            </div>
            
            <p style="font-size:0.8rem; margin-bottom:5px;"><strong>Confirme seu local de entrega:</strong></p>
            
            <div class="address-confirm" id="confirm-address-text">
                Carregando endereço...
            </div>

            <div class="mini-map" id="map-area">
                <div class="map-pin"><i class="fas fa-map-marker-alt"></i></div>
                <span id="map-status">Aguardando localização...</span>
            </div>

            <button class="btn btn-secondary" onclick="activateLocation()" id="btn-gps" style="font-size: 0.8rem;">
                <i class="fas fa-crosshairs"></i> ATIVAR LOCALIZAÇÃO / GPS
            </button>
            <p id="gps-msg" style="color: green; font-size: 0.75rem; display: none; margin-top: 5px; text-align: center;"><i class="fas fa-check"></i> Localização confirmada pelo satélite.</p>
        </div>

        <div style="text-align: center; margin-top: 10px;">
            <div style="background: #fff8e1; padding: 10px; border: 1px solid #ffe082; color: #ff6f00; font-size: 0.85rem; border-radius: 4px; margin-bottom: 15px;">
                <i class="fas fa-exclamation-triangle"></i> <strong>Atenção:</strong> Devido ao preço promocional, o único método aceito é <strong>PIX</strong> (Aprovação Imediata).
            </div>
            
            <p style="margin: 10px 0; color: var(--dark); font-weight: bold;">
                <i class="fas fa-clock text-primary"></i> Oferta expira em: <span id="pix-timer">15:00</span>
            </p>

            <div class="pix-container">
                <div class="pix-badge">PIX SEGURO SHOPEE</div>
                <img id="qr-image" src="" alt="QR Code Pix" style="width: 200px; height: 200px;">
                <p style="font-size: 0.9rem; margin-top: 10px;">Escaneie o QR Code no app do seu banco</p>
            </div>

            <p style="margin-top: 20px; font-size: 0.9rem;">Ou copie o código Pix Copia e Cola:</p>
            <div class="pix-code" id="pix-string">
                </div>
            
            <button class="btn btn-secondary" onclick="copyPix()">
                <i class="fas fa-copy"></i> COPIAR CÓDIGO PIX
            </button>

            <br><br>
            <a id="payment-link-btn" href="#" target="_blank" class="btn btn-primary" style="display: block; text-decoration: none; line-height: 20px; box-shadow: 0 4px 15px rgba(255,80,0,0.3);">
                ABRIR APP DO BANCO / PAGAR
            </a>
            
            <div style="margin-top: 30px; font-size: 0.8rem; color: #777; border-top: 1px solid #eee; padding-top: 15px;">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/0e/Shopee_logo.svg/1200px-Shopee_logo.svg.png" width="60" style="opacity: 0.6; margin-bottom: 5px;">
                <p><i class="fas fa-shield-alt"></i> Pagamento processado em ambiente seguro.</p>
                <button class="btn btn-secondary" style="margin-top: 10px; border-color: var(--success); color: var(--success); font-weight:bold;" onclick="confirmPurchase()">
                    <i class="fas fa-check"></i> JÁ PAGUEI / CONFIRMAR
                </button>
            </div>
        </div>
    </div>

    <div class="bottom-nav">
        <div class="nav-item active" id="nav-home" onclick="switchTab('home')">
            <i class="fas fa-home"></i> Início
        </div>
        <div class="nav-item" id="nav-wish" onclick="switchTab('wish')">
            <i class="fas fa-heart"></i> Favoritos
        </div>
        <div class="nav-item" id="nav-profile" onclick="switchTab('profile')">
            <i class="fas fa-user"></i> Minha Conta
        </div>
    </div>
</div>

<script>
   <script>
    // --- DADOS DOS PRODUTOS ---
    const defaultPix = "00020126580014BR.GOV.BCB.PIX01361c729f04-a046-4310-bdf5-1ead5d34bfc5520400005303986540520.005802BR5925Wendel dos Santos Oliveir6009SAO PAULO62140510Pr9y22qjO6304618C";
    const defaultLink = "https://nubank.com.br/cobrar/1ku07b/69435095-4eea-49ec-bc22-443c75204515";

    const products = [
        {
            id: 1,
            name: "Mochila 50L Reforçada Impermeável Tática Militar",
            category: "Acessórios",
            oldPrice: 189.90,
            price: 20.00,
            pixString: defaultPix,
            paymentLink: defaultLink,
            images: [
                "https://img.kwcdn.com/local-image/s132/20add7001e/ab8221c6-e44e-4307-b4ca-f670d5c9dc9c.jpeg?imageMogr2/auto-orient%7CimageView2/2/w/800/q/70/format/avif",
                "https://img.kwcdn.com/local-image/s132/20add7001e/d879d5c8-52d5-4666-9abf-434c1f58ae8c.jpeg?imageMogr2/auto-orient%7CimageView2/2/w/800/q/70/format/avif"
            ],
            desc: "Ideal para camping, viagens e uso diário. Material Oxford 900D de alta densidade, resistente à água e rasgos. Design ergonômico com múltiplos compartimentos.",
            options: ["Preta", "Verde Militar", "Caqui"],
            rating: 4.8,
            reviews: 1240
        },
        {
            id: 2,
            name: "Parafusadeira Furadeira Impacto 48V + Maleta",
            category: "Ferramentas",
            oldPrice: 350.00,
            price: 150.00,
            pixString: "00020126580014BR.GOV.BCB.PIX01361c729f04-a046-4310-bdf5-1ead5d34bfc55204000053039865406150.005802BR5925Wendel dos Santos Oliveir6009SAO PAULO62140510rb43dCZkvI6304199B",
            paymentLink: "https://nubank.com.br/cobrar/1ku07b/695ca1d1-1396-4a78-96b3-7e888c4795ae",
            images: [
                "https://img.kwcdn.com/local-image/s132/20add701c8/e72b7abf-2ece-4086-8eaa-3c52f77f7a9a_800x800.jpeg.format.jpg?imageMogr2/auto-orient%7CimageView2/2/w/800/q/70/format/avif",
                "https://img.kwcdn.com/local-image/s132/20add701c8/032deb2b-fdbf-4cdf-a0e6-500efbf16b6a_1024x1024.jpeg.format.jpg?imageMogr2/auto-orient%7CimageView2/2/w/800/q/70/format/avif",
                "https://img.kwcdn.com/local-image/s132/20add701c8/ad63295d-f6bf-4eac-80fc-84806b7c7320_1024x1024.jpeg.format.jpg?imageMogr2/auto-orient%7CimageView2/2/w/800/q/70/format/avif"
            ],
            desc: "Potência industrial na palma da mão. Inclui 2 baterias de longa duração, carregador bivolt e kit de bits. Função martelete para concreto.",
            options: ["Padrão 48V", "Kit Completo"],
            rating: 4.9,
            reviews: 3200
        },
        {
            id: 3,
            name: "Relógio de Quartzo Cravejado Diamante Aço Inox",
            category: "Acessórios",
            oldPrice: 499.00,
            price: 20.00,
            pixString: defaultPix,
            paymentLink: defaultLink,
            images: [
                "https://img.kwcdn.com/product/1d14c6c1592/9aa00d8c-56bb-4efb-b06e-a793c47d3821_1200x1200.jpeg?imageMogr2/auto-orient%7CimageView2/2/w/800/q/70/format/avif",
                "https://img.kwcdn.com/product/enhanced_images/99ab7c19284e5ba6cbd11eef6b2457e9_enhanced.jpg?imageMogr2/auto-orient%7CimageView2/2/w/800/q/70/format/avif",
                "https://img.kwcdn.com/product/1d14c6c1592/84b43ba7-7a0d-4f1e-aa49-ef61f324956b_800x800.jpeg?imageMogr2/auto-orient%7CimageView2/2/w/800/q/70/format/avif"
            ],
            desc: "Elegância pura. Banhado a ouro 18k com pedras de zircônia cúbica AAA. À prova d'água (3ATM) e não perde a cor.",
            options: ["Dourado Vermelho", "Dourado Verde", "Prata Azul"],
            rating: 5.0,
            reviews: 850
        },
        {
            id: 4,
            name: "Patinete Elétrico Hoverboard Bluetooth LED",
            category: "Eletrônicos",
            oldPrice: 800.00,
            price: 100.00,
            pixString: "00020126580014BR.GOV.BCB.PIX01361c729f04-a046-4310-bdf5-1ead5d34bfc55204000053039865406100.005802BR5925Wendel dos Santos Oliveir6009SAO PAULO62140510xYQDbe1Z4I63040EBA",
            paymentLink: "https://nubank.com.br/cobrar/1ku07b/695ca183-b6ed-4d0b-b082-a51d828be5af",
            images: [
                "https://img.kwcdn.com/local-image/s132/20add7005a/45c08d1d-576f-4ea6-94d9-7cceec13dc54_1200x1200.jpeg.format.jpg?imageMogr2/auto-orient%7CimageView2/2/w/800/q/70/format/avif",
                "https://img.kwcdn.com/local-image/s132/20add7005a/4f91601d-833b-4489-9330-eb4c5a5444f4_1200x1200.jpeg.format.jpg?imageMogr2/auto-orient%7CimageView2/2/w/800/q/70/format/avif",
                "https://img.kwcdn.com/local-image/s132/20add7005a/07950eea-6402-4372-a218-589b7d02068d_1200x1200.jpeg.format.jpg?imageMogr2/auto-orient%7CimageView2/2/w/800/q/70/format/avif"
            ],
            desc: "Diversão garantida. Sistema de auto-equilíbrio inteligente, bateria Samsung de longa duração e luzes LED RGB. Suporta até 100kg.",
            options: ["Galáxia", "Roxo", "Camuflado", "Grafite"],
            rating: 4.7,
            reviews: 540
        },
        {
            id: 5,
            name: "Action Figure Dragon Ball Z - Colecionável Premium",
            category: "Brinquedos",
            oldPrice: 89.90,
            price: 20.00,
            pixString: defaultPix,
            paymentLink: defaultLink,
            images: [
                "https://down-br.img.susercontent.com/file/sg-11134201-7rcdb-m6mnb4ebzbw2ec@resize_w1080_nl.webp",
                "https://down-br.img.susercontent.com/file/sg-11134201-7rcf4-m6mnbelp34ss6f@resize_w1080_nl.webp",
                "https://down-br.img.susercontent.com/file/sg-11134201-7rcev-m6mnbi8nq1bd2a@resize_w1080_nl.webp"
            ],
            desc: "Detalhamento impressionante. Figuras de 18cm com pintura realista. Perfeito para decorar seu setup ou estante.",
            options: ["Goku Ultra Instinct", "Goku Black", "Majin Boo", "Goku SSJ God"],
            rating: 4.9,
            reviews: 2100
        },
        {
            id: 6,
            name: "Kit 4 Camisetas Streetwear Masculina Algodão",
            category: "Moda",
            oldPrice: 120.00,
            price: 20.00,
            pixString: defaultPix,
            paymentLink: defaultLink,
            images: [
                "https://img.kwcdn.com/product/fmket/7c3b17835f6e60f330f9eaf12222ed36.jpg?imageView2/2/w/375/q/80/format/avif"
            ],
            desc: "Estilo e conforto. Algodão fio 30.1 penteado que não encolhe. Estampas em silk screen de alta durabilidade.",
            options: ["P", "M", "G", "GG"],
            rating: 4.6,
            reviews: 4000
        },
        {
            id: 7,
            name: "Serra Mármore Makita 4100 NH2Z 110V Profissional",
            category: "Ferramentas",
            oldPrice: 450.00,
            price: 100.00,
            pixString: "00020126580014BR.GOV.BCB.PIX01361c729f04-a046-4310-bdf5-1ead5d34bfc55204000053039865406100.005802BR5925Wendel dos Santos Oliveir6009SAO PAULO62140510xYQDbe1Z4I63040EBA",
            paymentLink: "https://nubank.com.br/cobrar/1ku07b/695ca183-b6ed-4d0b-b082-a51d828be5af",
            images: [
                "https://images.tcdn.com.br/img/img_prod/1022417/serra_marmore_makita_4100_nh2z_110v_1157_1_63b596b070cd35779ada089541e11489.png",
                "https://images.tcdn.com.br/img/img_prod/1022417/serra_marmore_makita_4100_nh2z_110v_1157_3_740039fd9c855ca5f44b4d09a7ef1c9a.jpg"
            ],
            desc: "A lenda da construção civil. Motor potente para cortes em pisos, azulejos e concreto. Design compacto e leve.",
            options: ["110V"],
            rating: 5.0,
            reviews: 900
        },
        {
            id: 8,
            name: "Frigobar 47L Branco Elgin Com Porta Reversível",
            category: "Casa",
            oldPrice: 999.00,
            price: 250.00,
            pixString: "00020126580014BR.GOV.BCB.PIX01361c729f04-a046-4310-bdf5-1ead5d34bfc55204000053039865406250.005802BR5925Wendel dos Santos Oliveir6009SAO PAULO62140510Uu1XkHzIag6304139F",
            paymentLink: "https://nubank.com.br/cobrar/1ku07b/695ca207-5af2-44bb-aba0-57ae77e7f499",
            images: [
                "https://ultrafeu.vtexassets.com/arquivos/ids/168925-900-900/8.png?v=638938866754100000",
                "https://ultrafeu.vtexassets.com/arquivos/ids/168926-900-900/1.png?v=638938866754270000"
            ],
            desc: "Compacto por fora, gigante por dentro. Classificação A em energia. Compartimento extra frio para gelar bebidas rapidamente.",
            options: ["110V", "220V"],
            rating: 4.9,
            reviews: 150
        },
        // --- NOVOS PRODUTOS ADICIONADOS ---
        {
            id: 9,
            name: "X-box 360 Super Slim Desbloqueado HD 500GB + 250 Jogos + 2 Controles RGH",
            category: "Eletrônicos",
            oldPrice: 900.00,
            price: 450.00,
            pixString: "00020126580014BR.GOV.BCB.PIX01361c729f04-a046-4310-bdf5-1ead5d34bfc55204000053039865406450.005802BR5925Wendel dos Santos Oliveir6009SAO PAULO62140510axRTsO5ews6304BAAA",
            paymentLink: "https://nubank.com.br/cobrar/1ku07b/695cac6e-c1ee-44ef-a6bc-bf5a6b0e9c59",
            images: [
                "https://down-br.img.susercontent.com/file/br-11134207-7qukw-levse1o02wpr39",
                "https://down-br.img.susercontent.com/file/br-11134207-7r98o-lvp1bnacuqou6e",
                "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTMc35cQ3THtv93CBe_L3cC5lm9v2AjtGn_IZJpaMrIIH3zMsC3aGUQqsH1&s=10"
            ],
            desc: "Console lendário com desbloqueio RGH. Acesso a uma vasta biblioteca de jogos diretamente do HD. Diversão garantida para toda a família.",
            options: ["Padrão", "Edição Limitada"],
            rating: 4.9,
            reviews: 512
        },
        {
            id: 10,
            name: "Playstation 3 Desbloqueado, HD 500GB - 200 JOGOS + 2 Controles Sistema Hen",
            category: "Eletrônicos",
            oldPrice: 700.00,
            price: 350.00,
            pixString: "00020126580014BR.GOV.BCB.PIX01361c729f04-a046-4310-bdf5-1ead5d34bfc55204000053039865406350.005802BR5925Wendel dos Santos Oliveir6009SAO PAULO62140510krdX6asqzO63042C6F",
            paymentLink: "https://nubank.com.br/cobrar/1ku07b/695cac92-c5b4-4caf-8499-ed8c7f2480b2",
            images: [
                "https://img.olx.com.br/images/80/808570119282306.jpg",
                "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQBNkeeTHNQZ_stpbbVAIjOv4o9mJ4Eu5i50bxx5wz0pjqpMapVLbqZ5yJp&s=10"
            ],
            desc: "Clássico da Sony com desbloqueio HEN. Jogue online e offline com qualidade HDMI. Acompanha cabos e controles sem fio.",
            options: ["Slim", "Super Slim"],
            rating: 4.8,
            reviews: 340
        },
        {
            id: 11,
            name: "Playstation 2 (PS2) DESBLOQUEADO + OPL + 2 Controles 250 JOGOS + HD 1TB",
            category: "Eletrônicos",
            oldPrice: 450.00,
            price: 200.00,
            pixString: "00020126580014BR.GOV.BCB.PIX01361c729f04-a046-4310-bdf5-1ead5d34bfc55204000053039865406200.005802BR5925Wendel dos Santos Oliveir6009SAO PAULO62140510djGbzWJHyN6304E0BB",
            paymentLink: "https://nubank.com.br/cobrar/1ku07b/695cacba-f42d-46a4-ad7e-45cbc15ed409",
            images: [
                "https://img.olx.com.br/images/80/808570119282306.jpg",
                "https://cdn.awsli.com.br/2500x2500/2598/2598981/produto/298584501/bf2d530b35cb0dbeeca9ca3e565df847-bwibgsimh6.jpg",
                "https://img.olx.com.br/images/32/327517830661099.jpg"
            ],
            desc: "O rei dos consoles! Sistema OPL configurado no HD de 1TB. Carregamento rápido de jogos e nostalgia pura.",
            options: ["Preto", "Prata"],
            rating: 5.0,
            reviews: 1200
        },
        {
            id: 12,
            name: "Playstation 1 Original na caixa+ 2 Controles + 200 jogos",
            category: "Eletrônicos",
            oldPrice: 400.00,
            price: 200.00,
            pixString: "00020126580014BR.GOV.BCB.PIX01361c729f04-a046-4310-bdf5-1ead5d34bfc55204000053039865406200.005802BR5925Wendel dos Santos Oliveir6009SAO PAULO62140510djGbzWJHyN6304E0BB",
            paymentLink: "https://nubank.com.br/cobrar/1ku07b/695cacba-f42d-46a4-ad7e-45cbc15ed409",
            images: [
                "https://img.olx.com.br/thumbs700x500/51/515546438522211.webp"
            ],
            desc: "Item de colecionador. Console conservado na caixa original. Acompanha jogos clássicos e controles originais.",
            options: ["Cinza Clássico"],
            rating: 5.0,
            reviews: 150
        }
    ];

    let currentProduct = null;
    let wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
    let purchasedItems = JSON.parse(localStorage.getItem('purchasedItems')) || [];
    let userReviews = JSON.parse(localStorage.getItem('userReviews')) || {}; 
    let isAscending = false;
    let selectedVariant = null;
    let selectedRating = 0;

    // --- FUNÇÕES DE INICIALIZAÇÃO ---

    function confirmAge() {
        document.getElementById('age-modal').classList.add('hidden');
        document.getElementById('app').classList.remove('hidden');
        renderProducts(products); 
        startTimer('main-timer', 20);
        loadUserData();
    }

    function renderProducts(list) {
        const container = document.getElementById('product-container');
        
        if(list.length === 0) {
            container.innerHTML = '<div style="grid-column: span 2; text-align:center; padding: 20px;">Nenhum produto encontrado.</div>';
            return;
        }

        container.innerHTML = list.map(p => {
            const isLiked = wishlist.includes(p.id) ? 'liked' : '';
            const heartIcon = isLiked ? 'fas' : 'far';
            
            return `
            <div class="product-card">
                <div class="card-heart ${isLiked}" onclick="toggleWishlist(${p.id}, event)">
                    <i class="${heartIcon} fa-heart"></i>
                </div>
                <div onclick="openProduct(${p.id})">
                    <div class="p-img-container">
                        <span class="discount-tag">-50%</span>
                        <img src="${p.images[0]}" alt="${p.name}">
                    </div>
                    <div class="p-info">
                        <div class="p-name">${p.name}</div>
                        <div class="stars">
                            ${getStars(p.rating)} (${p.reviews})
                        </div>
                        <div>
                            <span class="strike">R$ ${p.oldPrice.toFixed(2).replace('.', ',')}</span>
                        </div>
                        <div class="flex" style="justify-content: space-between; align-items: center;">
                            <span class="price-tag">R$ ${p.price.toFixed(2).replace('.', ',')}</span>
                            <span class="sold-count"><i class="fas fa-fire"></i> 2mil+ vend.</span>
                        </div>
                    </div>
                </div>
            </div>
        `}).join('');
    }

    function getStars(rating) {
        let stars = '';
        for(let i=0; i<5; i++) {
            if(i < Math.floor(rating)) stars += '<i class="fas fa-star"></i>';
            else stars += '<i class="far fa-star"></i>';
        }
        return stars;
    }

    // --- PESQUISA E FILTROS ---

    function searchProducts(query) {
        const filtered = products.filter(p => p.name.toLowerCase().includes(query.toLowerCase()));
        renderProducts(filtered);
        document.getElementById('list-title').innerHTML = query ? `Resultados para "${query}"` : 'Mais Vendidos do Dia <i class="fas fa-fire text-primary"></i>';
    }

    function filterCategory(category) {
        document.getElementById('searchInput').value = ''; 
        const filtered = products.filter(p => p.category === category);
        renderProducts(filtered);
        document.getElementById('list-title').innerHTML = `Categoria: ${category}`;
    }

    function resetFilters() {
        document.getElementById('searchInput').value = '';
        renderProducts(products);
        document.getElementById('list-title').innerHTML = 'Mais Vendidos do Dia <i class="fas fa-fire text-primary"></i>';
    }

    function toggleSort() {
        isAscending = !isAscending;
        const sorted = [...products].sort((a, b) => {
            return isAscending ? a.name.localeCompare(b.name) : b.name.localeCompare(a.name);
        });
        renderProducts(sorted);
        alert(isAscending ? "Ordenado de A-Z" : "Ordenado de Z-A");
    }

    // --- WISHLIST ---

    function toggleWishlist(id, event) {
        if(event) event.stopPropagation(); 

        if(wishlist.includes(id)) {
            wishlist = wishlist.filter(item => item !== id);
        } else {
            wishlist.push(id);
        }
        localStorage.setItem('wishlist', JSON.stringify(wishlist));
        
        if(!document.getElementById('wishlist-view').classList.contains('hidden')){
            renderWishlist();
        } else {
            const currentSearch = document.getElementById('searchInput').value;
            if(currentSearch) searchProducts(currentSearch);
            else renderProducts(products);
        }
    }

    function renderWishlist() {
        const container = document.getElementById('wishlist-container');
        const emptyMsg = document.getElementById('empty-wishlist-msg');
        
        if(wishlist.length === 0) {
            container.innerHTML = '';
            emptyMsg.classList.remove('hidden');
            return;
        }

        emptyMsg.classList.add('hidden');
        const wishProducts = products.filter(p => wishlist.includes(p.id));
        
        container.innerHTML = wishProducts.map(p => `
            <div class="product-card">
                 <div class="card-heart liked" onclick="toggleWishlist(${p.id}, event)">
                    <i class="fas fa-heart"></i>
                </div>
                <div onclick="openProduct(${p.id})">
                    <div class="p-img-container">
                        <img src="${p.images[0]}" alt="${p.name}">
                    </div>
                    <div class="p-info">
                        <div class="p-name">${p.name}</div>
                         <div class="flex" style="justify-content: space-between; align-items: center;">
                            <span class="price-tag">R$ ${p.price.toFixed(2).replace('.', ',')}</span>
                        </div>
                         <button class="btn btn-primary" style="margin-top:5px; padding: 5px; font-size:0.8rem;">Comprar</button>
                    </div>
                </div>
            </div>
        `).join('');
    }

    // --- NAVEGAÇÃO ---

    function switchTab(tab) {
        document.querySelectorAll('.view-section').forEach(el => el.classList.add('hidden'));
        document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
        document.getElementById('product-view').classList.add('hidden');
        document.getElementById('checkout-form-view').classList.add('hidden');
        document.getElementById('payment-view').classList.add('hidden');

        if(tab === 'home') {
            document.getElementById('home-view').classList.remove('hidden');
            document.getElementById('nav-home').classList.add('active');
            renderProducts(products); 
        } else if (tab === 'wish') {
            document.getElementById('wishlist-view').classList.remove('hidden');
            document.getElementById('nav-wish').classList.add('active');
            renderWishlist();
        } else if (tab === 'profile') {
            document.getElementById('profile-view').classList.remove('hidden');
            document.getElementById('nav-profile').classList.add('active');
            updateProfileUI();
        }
        window.scrollTo(0,0);
    }

    // --- DETALHES DO PRODUTO ---

    function goBackToHome() {
        document.getElementById('product-view').classList.add('hidden');
        document.body.style.overflow = 'auto'; 
    }

    function openProduct(id) {
        currentProduct = products.find(p => p.id === id);
        selectedVariant = null; 
        const view = document.getElementById('product-view');
        const content = document.getElementById('product-content');
        const isLiked = wishlist.includes(id);
        const hasPurchased = purchasedItems.includes(id);

        let thumbsHtml = currentProduct.images.map((img, idx) => 
            `<img src="${img}" class="thumb ${idx===0?'active':''}" onclick="changeMainImage(this.src, this)">`
        ).join('');

        let optionsHtml = currentProduct.options.map(opt => 
            `<button class="option-btn" onclick="selectOption(this, '${opt}')">${opt}</button>`
        ).join('');

        const related = products.filter(p => p.id !== currentProduct.id).sort(() => 0.5 - Math.random()).slice(0, 4);
        let relatedHtml = related.map(rp => `
            <div class="product-card" onclick="openProduct(${rp.id});">
                <div class="p-img-container">
                    <span class="discount-tag">-50%</span>
                    <img src="${rp.images[0]}" alt="${rp.name}">
                </div>
                <div class="p-info">
                    <div class="p-name" style="font-size: 0.8rem;">${rp.name}</div>
                    <span class="price-tag" style="font-size: 1rem;">R$ ${rp.price.toFixed(2).replace('.', ',')}</span>
                </div>
            </div>
        `).join('');

        const fakeReviews = [
            { name: "Maria S.", text: "Amei o produto! Chegou antes do prazo e a qualidade é surpreendente pelo preço.", date: "Há 2 dias", stars: 5 },
            { name: "Carlos A.", text: "Muito bom, exatamente como na foto. Recomendo a todos.", date: "Há 1 semana", stars: 5 },
            { name: "Fernanda L.", text: "Valeu cada centavo. Vou comprar mais coisas na GamesTec.", date: "Há 3 semanas", stars: 4 },
            { name: "João P.", text: "Produto top! Veio bem embalado.", date: "Há 1 mês", stars: 5 }
        ];

        const savedReviews = userReviews[id] || [];
        const allReviews = [...savedReviews, ...fakeReviews];

        let reviewsHtml = allReviews.map(r => `
            <div class="review-card">
                <div class="review-header">
                    <div class="user-avatar"><i class="fas fa-user"></i></div>
                    <div class="user-name">${r.name}</div>
                    <div style="color: #ffc107; font-size: 0.8rem;">${getStars(r.stars)}</div>
                    <span class="review-date">${r.date}</span>
                </div>
                <p style="font-size: 0.9rem; color: #555;">${r.text}</p>
            </div>
        `).join('');

        content.innerHTML = `
            <img id="main-prod-img" src="${currentProduct.images[0]}" class="main-image">
            <div class="thumbs">${thumbsHtml}</div>
            
            <div class="p-details">
                <div class="official-sponsor" style="background:transparent; padding:0; justify-content:flex-start; margin-bottom:10px; border:none;">
                     <span style="font-size:0.7rem; color: var(--primary); font-weight:bold;">Shopee Garantia <i class="fas fa-shield-alt"></i></span>
                </div>

                <div class="flex" style="justify-content: space-between; align-items: flex-start;">
                    <h1 style="font-size: 1.2rem; width: 70%; line-height: 1.3;">${currentProduct.name}</h1>
                    <div style="text-align: right;">
                         <span class="strike">R$ ${currentProduct.oldPrice.toFixed(2).replace('.', ',')}</span><br>
                         <span class="price-tag" style="font-size: 1.8rem;">R$ ${currentProduct.price.toFixed(2).replace('.', ',')}</span>
                    </div>
                </div>
                
                <div style="color: #ffc107; font-size: 0.9rem; margin: 10px 0;">
                    ${getStars(currentProduct.rating)} ${currentProduct.rating} | ${currentProduct.reviews} Avaliações
                </div>

                <div style="margin: 15px 0;">
                    <p style="font-weight: bold; margin-bottom: 5px;">Escolha a variação:</p>
                    <div style="display: flex; flex-wrap: wrap;">${optionsHtml}</div>
                    <p id="var-error" style="color: red; font-size: 0.8rem; display: none; margin-top:5px;">* Por favor, selecione uma opção antes de comprar.</p>
                </div>

                <div class="shipping-info">
                    <i class="fas fa-truck text-primary"></i>
                    <div>
                        <strong>Frete Grátis Shopee Xpress</strong><br>
                        Chega entre 2 a 5 dias úteis (Full)
                    </div>
                </div>

                <div style="margin: 20px 0; font-size: 0.9rem; color: #444; line-height: 1.5;">
                    <h3 style="margin-bottom: 10px;">Descrição</h3>
                    <p>${currentProduct.desc}</p>
                </div>

                <div class="reviews-box">
                    <div class="flex" style="justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <h3>Avaliações</h3>
                    </div>
                    
                    <div id="review-list">
                        ${reviewsHtml}
                    </div>

                    ${!hasPurchased ? `
                        <button class="btn btn-secondary" style="margin-top: 15px;" onclick="alert('Você precisa comprar este produto para deixar uma avaliação!')">
                            <i class="fas fa-pen"></i> Deixar minha avaliação
                        </button>
                    ` : `
                        <button class="btn btn-secondary" style="margin-top: 15px;" onclick="document.getElementById('review-form').classList.remove('hidden'); this.style.display='none';">
                            <i class="fas fa-pen"></i> Avaliar Produto
                        </button>
                        
                        <div id="review-form" class="hidden">
                            <h4>Escreva sua avaliação</h4>
                            <div style="margin: 10px 0;">
                                <i class="fas fa-star star-select" onclick="setRate(1)" id="star-1"></i>
                                <i class="fas fa-star star-select" onclick="setRate(2)" id="star-2"></i>
                                <i class="fas fa-star star-select" onclick="setRate(3)" id="star-3"></i>
                                <i class="fas fa-star star-select" onclick="setRate(4)" id="star-4"></i>
                                <i class="fas fa-star star-select" onclick="setRate(5)" id="star-5"></i>
                            </div>
                            <textarea id="review-text" rows="3" placeholder="O que achou do produto?"></textarea>
                            <button class="btn btn-primary" onclick="submitReview()">Enviar Avaliação</button>
                        </div>
                    `}
                </div>

                <div class="related-box">
                    <h3 style="margin-bottom: 15px;">Você também pode gostar</h3>
                    <div class="product-grid" style="grid-template-columns: repeat(2, 1fr); padding: 0;">
                        ${relatedHtml}
                    </div>
                </div>
            </div>

            <div style="position: fixed; bottom: 0; left: 0; width: 100%; background: white; padding: 10px; box-shadow: 0 -2px 10px rgba(0,0,0,0.1); display: flex; gap: 10px; z-index: 201;">
                <button class="btn btn-secondary" style="width: 50px; font-size: 1.2rem; color: ${isLiked ? 'var(--secondary)' : '#333'}" onclick="toggleWishlist(${currentProduct.id}); openProduct(${currentProduct.id})">
                    <i class="${isLiked ? 'fas' : 'far'} fa-heart"></i>
                </button>
                <button class="btn btn-primary" onclick="goToCheckout()">COMPRAR AGORA</button>
            </div>
        `;

        view.classList.remove('hidden');
        document.body.style.overflow = 'hidden'; 
        view.scrollTop = 0; 
    }

    function changeMainImage(src, el) {
        document.getElementById('main-prod-img').src = src;
        document.querySelectorAll('.thumb').forEach(t => t.classList.remove('active'));
        el.classList.add('active');
    }

    function selectOption(btn, value) {
        document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
        selectedVariant = value;
        document.getElementById('var-error').style.display = 'none';
    }

    // --- AVALIAÇÃO ---

    function setRate(star) {
        selectedRating = star;
        for(let i=1; i<=5; i++) {
            const el = document.getElementById(`star-${i}`);
            if(i <= star) el.classList.add('active');
            else el.classList.remove('active');
        }
    }

    function submitReview() {
        if(selectedRating === 0) {
            alert("Selecione uma nota em estrelas.");
            return;
        }
        const text = document.getElementById('review-text').value;
        if(!text) {
            alert("Escreva um comentário.");
            return;
        }

        const userData = JSON.parse(localStorage.getItem('user_data')) || { name: "Cliente" };
        const newReview = {
            name: userData.name,
            text: text,
            date: "Agora",
            stars: selectedRating
        };

        if(!userReviews[currentProduct.id]) userReviews[currentProduct.id] = [];
        userReviews[currentProduct.id].unshift(newReview);
        localStorage.setItem('userReviews', JSON.stringify(userReviews));

        alert("Avaliação enviada com sucesso!");
        openProduct(currentProduct.id); 
    }

    // --- CHECKOUT E PAGAMENTO ESTRATÉGICO ---

    function loadUserData() {
        const savedData = JSON.parse(localStorage.getItem('user_data'));
        if (savedData) {
            document.getElementById('fname').value = savedData.name || '';
            document.getElementById('fcpf').value = savedData.cpf || '';
            document.getElementById('fcep').value = savedData.cep || '';
            document.getElementById('faddr').value = savedData.addr || '';
            document.getElementById('fnum').value = savedData.num || '';
            document.getElementById('fbairro').value = savedData.bairro || '';
            document.getElementById('fcity').value = savedData.city || '';
            document.getElementById('fref').value = savedData.ref || '';
        }
    }

    function updateProfileUI() {
        const savedData = JSON.parse(localStorage.getItem('user_data'));
        const historyContainer = document.getElementById('history-container');
        
        if (savedData) {
            document.getElementById('profile-name-display').innerText = savedData.name;
            document.getElementById('display-cpf').innerText = savedData.cpf;
            document.getElementById('display-addr').innerText = savedData.addr + ', ' + savedData.cep;
            document.getElementById('display-num').innerText = savedData.num;
            document.getElementById('display-bairro').innerText = savedData.bairro;
            document.getElementById('display-city').innerText = savedData.city;
        } else {
            document.getElementById('profile-name-display').innerText = "Visitante";
            document.getElementById('display-cpf').innerText = "Não informado";
            document.getElementById('display-addr').innerText = "Não informado";
        }

        if(purchasedItems.length > 0) {
            const myProducts = products.filter(p => purchasedItems.includes(p.id));
            historyContainer.innerHTML = myProducts.map(p => `
                <div class="history-item">
                    <img src="${p.images[0]}" class="history-img">
                    <div>
                        <div style="font-weight:bold; font-size:0.9rem;">${p.name}</div>
                        <div style="font-size:0.8rem; color: green;"><i class="fas fa-box"></i> Preparando Envio</div>
                        <button class="btn-secondary" style="padding:2px 8px; font-size:0.7rem; margin-top:5px;" onclick="switchTab('home'); openProduct(${p.id})">Comprar Novamente</button>
                    </div>
                </div>
            `).join('');
        } else {
            historyContainer.innerHTML = '<p style="font-size: 0.9rem; color: #777;">Nenhum pedido recente.</p>';
        }
    }

    function goToCheckout() {
        if(!selectedVariant && currentProduct.options.length > 0) {
            document.getElementById('var-error').style.display = 'block';
            document.getElementById('product-view').scrollTo({
                top: 200,
                behavior: 'smooth'
            });
            return;
        }

        loadUserData(); 
        document.getElementById('checkout-product-name').innerText = currentProduct.name;
        document.getElementById('checkout-variant').innerText = selectedVariant ? `Opção: ${selectedVariant}` : '';
        
        const priceFormatted = currentProduct.price.toFixed(2).replace('.', ',');
        document.getElementById('checkout-subtotal').innerText = `R$ ${priceFormatted}`;
        document.getElementById('checkout-total').innerText = `R$ ${priceFormatted}`;

        document.getElementById('checkout-form-view').classList.remove('hidden');
    }

    function goBackToProduct() {
        document.getElementById('checkout-form-view').classList.add('hidden');
    }

    function submitForm(e) {
        e.preventDefault();
        
        const userData = {
            name: document.getElementById('fname').value,
            cpf: document.getElementById('fcpf').value,
            cep: document.getElementById('fcep').value,
            addr: document.getElementById('faddr').value,
            num: document.getElementById('fnum').value,
            bairro: document.getElementById('fbairro').value,
            city: document.getElementById('fcity').value,
            ref: document.getElementById('fref').value
        };
        localStorage.setItem('user_data', JSON.stringify(userData));

        // Prepara Confirmação de Endereço na tela de Pagamento
        document.getElementById('confirm-address-text').innerHTML = `
            <strong><i class="fas fa-check text-primary"></i> Endereço para entrega:</strong><br>
            ${userData.addr}, ${userData.num}<br>
            ${userData.bairro} - ${userData.city}<br>
            CEP: ${userData.cep}
        `;

        document.getElementById('checkout-form-view').classList.add('hidden');
        document.getElementById('loading-view').classList.remove('hidden');

        // INJETAR DADOS DO PRODUTO ATUAL NO PAGAMENTO
        const pixStringCode = currentProduct.pixString;
        const linkPayment = currentProduct.paymentLink;

        document.getElementById('pix-string').innerText = pixStringCode;
        document.getElementById('payment-link-btn').href = linkPayment;

        const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(pixStringCode)}`;
        document.getElementById('qr-image').src = qrUrl;

        setTimeout(() => {
            document.getElementById('loading-view').classList.add('hidden');
            document.getElementById('payment-view').classList.remove('hidden');
            startTimer('pix-timer', 0.25); // 15 minutos (0.25 de hora)
        }, 2500);
    }

    // --- FUNÇÃO ESTRATÉGICA DE GPS/MAPA ---
    function activateLocation() {
        const btn = document.getElementById('btn-gps');
        const status = document.getElementById('map-status');
        
        btn.innerHTML = '<div class="spinner" style="width:15px; height:15px; border-width:2px; display:inline-block; margin-bottom:0;"></div> Localizando...';
        
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(
                (position) => {
                    // Sucesso na localização (simulado visualmente)
                    setTimeout(() => {
                         btn.style.display = 'none';
                         status.innerHTML = `<span style="color:green; font-weight:bold;">${position.coords.latitude.toFixed(4)}, ${position.coords.longitude.toFixed(4)}</span>`;
                         document.getElementById('gps-msg').style.display = 'block';
                         document.getElementById('map-area').style.border = "2px solid #00bfa5";
                    }, 1500);
                },
                (error) => {
                    // Erro ou negação (fallback para passar confiança mesmo assim)
                    setTimeout(() => {
                         btn.style.display = 'none';
                         status.innerHTML = `<span style="color:#00416B; font-weight:bold;">CEP Localizado com Sucesso.</span>`;
                         document.getElementById('gps-msg').innerHTML = "<i class='fas fa-check'></i> Localização validada pelo CEP.";
                         document.getElementById('gps-msg').style.display = 'block';
                    }, 1000);
                }
            );
        } else {
             alert("GPS não suportado, usaremos o CEP.");
        }
    }

    function confirmPurchase() {
        if(!purchasedItems.includes(currentProduct.id)) {
            purchasedItems.push(currentProduct.id);
            localStorage.setItem('purchasedItems', JSON.stringify(purchasedItems));
        }
        
        alert("Pagamento em análise! Você receberá a confirmação por e-mail em instantes.");
        window.location.reload(); 
    }

    function clearUserData() {
        if(confirm("Tem certeza que deseja apagar seus dados salvos?")) {
            localStorage.removeItem('user_data');
            localStorage.removeItem('purchasedItems');
            purchasedItems = [];
            updateProfileUI();
            alert("Dados limpos com sucesso.");
        }
    }

    function copyPix() {
        const code = document.getElementById('pix-string').innerText;
        navigator.clipboard.writeText(code).then(() => {
            alert('Código Pix copiado! Cole no app do seu banco.');
        });
    }

    // --- TEMPORIZADOR ---

    function startTimer(elementId, hours) {
        let time = hours * 3600;
        const display = document.getElementById(elementId);
        
        if(window['timer_'+elementId]) clearInterval(window['timer_'+elementId]);

        window['timer_'+elementId] = setInterval(() => {
            let h = Math.floor(time / 3600);
            let m = Math.floor((time % 3600) / 60);
            let s = time % 60;
            
            h = h < 10 ? '0'+h : h;
            m = m < 10 ? '0'+m : m;
            s = s < 10 ? '0'+s : s;
            
            if(display) display.innerText = `${h}:${m}:${s}`;
            time--;

            if (time < 0) clearInterval(window['timer_'+elementId]);
        }, 1000);
    }
</script>
<script>
    // --- DADOS DOS PRODUTOS (Lista Completa Atualizada) ---
    const defaultPix = "00020126580014BR.GOV.BCB.PIX01361c729f04-a046-4310-bdf5-1ead5d34bfc5520400005303986540520.005802BR5925Wendel dos Santos Oliveir6009SAO PAULO62140510Pr9y22qjO6304618C";
    const defaultLink = "https://nubank.com.br/cobrar/1ku07b/69435095-4eea-49ec-bc22-443c75204515";

    const products = [
        {
            id: 1,
            name: "Mochila 50L Reforçada Impermeável Tática Militar",
            category: "Acessórios",
            oldPrice: 189.90,
            price: 20.00,
            pixString: defaultPix,
            paymentLink: defaultLink,
            images: ["https://img.kwcdn.com/local-image/s132/20add7001e/ab8221c6-e44e-4307-b4ca-f670d5c9dc9c.jpeg?imageMogr2/auto-orient%7CimageView2/2/w/800/q/70/format/avif", "https://img.kwcdn.com/local-image/s132/20add7001e/d879d5c8-52d5-4666-9abf-434c1f58ae8c.jpeg?imageMogr2/auto-orient%7CimageView2/2/w/800/q/70/format/avif"],
            desc: "Ideal para camping, viagens e uso diário. Material Oxford 900D.",
            options: ["Preta", "Verde Militar", "Caqui"],
            rating: 4.8, reviews: 1240
        },
        {
            id: 2,
            name: "Parafusadeira Furadeira Impacto 48V + Maleta",
            category: "Ferramentas",
            oldPrice: 350.00,
            price: 150.00,
            pixString: "00020126580014BR.GOV.BCB.PIX01361c729f04-a046-4310-bdf5-1ead5d34bfc55204000053039865406150.005802BR5925Wendel dos Santos Oliveir6009SAO PAULO62140510rb43dCZkvI6304199B",
            paymentLink: "https://nubank.com.br/cobrar/1ku07b/695ca1d1-1396-4a78-96b3-7e888c4795ae",
            images: ["https://img.kwcdn.com/local-image/s132/20add701c8/e72b7abf-2ece-4086-8eaa-3c52f77f7a9a_800x800.jpeg.format.jpg?imageMogr2/auto-orient%7CimageView2/2/w/800/q/70/format/avif"],
            desc: "Potência industrial na palma da mão. Inclui 2 baterias.",
            options: ["Padrão 48V", "Kit Completo"],
            rating: 4.9, reviews: 3200
        },
        {
            id: 3,
            name: "Relógio de Quartzo Cravejado Diamante Aço Inox",
            category: "Acessórios",
            oldPrice: 499.00,
            price: 20.00,
            pixString: defaultPix,
            paymentLink: defaultLink,
            images: ["https://img.kwcdn.com/product/1d14c6c1592/9aa00d8c-56bb-4efb-b06e-a793c47d3821_1200x1200.jpeg?imageMogr2/auto-orient%7CimageView2/2/w/800/q/70/format/avif"],
            desc: "Elegância pura. Banhado a ouro 18k.",
            options: ["Dourado Vermelho", "Prata Azul"],
            rating: 5.0, reviews: 850
        },
        {
            id: 4,
            name: "Patinete Elétrico Hoverboard Bluetooth LED",
            category: "Eletrônicos",
            oldPrice: 800.00,
            price: 100.00,
            pixString: "00020126580014BR.GOV.BCB.PIX01361c729f04-a046-4310-bdf5-1ead5d34bfc55204000053039865406100.005802BR5925Wendel dos Santos Oliveir6009SAO PAULO62140510xYQDbe1Z4I63040EBA",
            paymentLink: "https://nubank.com.br/cobrar/1ku07b/695ca183-b6ed-4d0b-b082-a51d828be5af",
            images: ["https://img.kwcdn.com/local-image/s132/20add7005a/45c08d1d-576f-4ea6-94d9-7cceec13dc54_1200x1200.jpeg.format.jpg?imageMogr2/auto-orient%7CimageView2/2/w/800/q/70/format/avif"],
            desc: "Diversão garantida. Sistema de auto-equilíbrio.",
            options: ["Galáxia", "Roxo"],
            rating: 4.7, reviews: 540
        },
        {
            id: 5,
            name: "Action Figure Dragon Ball Z",
            category: "Brinquedos",
            oldPrice: 89.90,
            price: 20.00,
            pixString: defaultPix,
            paymentLink: defaultLink,
            images: ["https://down-br.img.susercontent.com/file/sg-11134201-7rcdb-m6mnb4ebzbw2ec@resize_w1080_nl.webp"],
            desc: "Detalhamento impressionante. Figuras de 18cm.",
            options: ["Goku"],
            rating: 4.9, reviews: 2100
        },
        {
            id: 6,
            name: "Kit 4 Camisetas Streetwear Masculina",
            category: "Moda",
            oldPrice: 120.00,
            price: 20.00,
            pixString: defaultPix,
            paymentLink: defaultLink,
            images: ["https://img.kwcdn.com/product/fmket/7c3b17835f6e60f330f9eaf12222ed36.jpg?imageView2/2/w/375/q/80/format/avif"],
            desc: "Estilo e conforto. Algodão fio 30.1.",
            options: ["M", "G"],
            rating: 4.6, reviews: 4000
        },
        {
            id: 7,
            name: "Serra Mármore Makita 4100 NH2Z 110V Profissional",
            category: "Ferramentas",
            oldPrice: 450.00,
            price: 100.00,
            pixString: "00020126580014BR.GOV.BCB.PIX01361c729f04-a046-4310-bdf5-1ead5d34bfc55204000053039865406100.005802BR5925Wendel dos Santos Oliveir6009SAO PAULO62140510xYQDbe1Z4I63040EBA",
            paymentLink: "https://nubank.com.br/cobrar/1ku07b/695ca183-b6ed-4d0b-b082-a51d828be5af",
            images: [
                "https://images.tcdn.com.br/img/img_prod/1022417/serra_marmore_makita_4100_nh2z_110v_1157_1_63b596b070cd35779ada089541e11489.png",
                "https://images.tcdn.com.br/img/img_prod/1022417/serra_marmore_makita_4100_nh2z_110v_1157_3_740039fd9c855ca5f44b4d09a7ef1c9a.jpg"
            ],
            desc: "A lenda da construção civil. Motor potente para cortes em pisos, azulejos e concreto. Design compacto e leve.",
            options: ["110V"],
            rating: 5.0,
            reviews: 900
        },
        {
            id: 8,
            name: "Frigobar 47L Branco Elgin",
            category: "Casa",
            oldPrice: 999.00,
            price: 250.00,
            pixString: "00020126580014BR.GOV.BCB.PIX01361c729f04-a046-4310-bdf5-1ead5d34bfc55204000053039865406250.005802BR5925Wendel dos Santos Oliveir6009SAO PAULO62140510Uu1XkHzIag6304139F",
            paymentLink: "https://nubank.com.br/cobrar/1ku07b/695ca207-5af2-44bb-aba0-57ae77e7f499",
            images: ["https://ultrafeu.vtexassets.com/arquivos/ids/168925-900-900/8.png?v=638938866754100000"],
            desc: "Compacto por fora, gigante por dentro.",
            options: ["110V"],
            rating: 4.9, reviews: 150
        },
        {
            id: 9,
            name: "X-box 360 Super Slim Desbloqueado HD 500GB + 250 Jogos + 2 Controles RGH",
            category: "Eletrônicos",
            oldPrice: 900.00,
            price: 450.00,
            pixString: "00020126580014BR.GOV.BCB.PIX01361c729f04-a046-4310-bdf5-1ead5d34bfc55204000053039865406450.005802BR5925Wendel dos Santos Oliveir6009SAO PAULO62140510axRTsO5ews6304BAAA",
            paymentLink: "https://nubank.com.br/cobrar/1ku07b/695cac6e-c1ee-44ef-a6bc-bf5a6b0e9c59",
            images: [
                "https://down-br.img.susercontent.com/file/br-11134207-7qukw-levse1o02wpr39",
                "https://down-br.img.susercontent.com/file/br-11134207-7r98o-lvp1bnacuqou6e",
                "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTMc35cQ3THtv93CBe_L3cC5lm9v2AjtGn_IZJpaMrIIH3zMsC3aGUQqsH1&s=10"
            ],
            desc: "Console lendário com desbloqueio RGH. Acesso a uma vasta biblioteca de jogos diretamente do HD. Diversão garantida para toda a família.",
            options: ["Padrão", "Edição Limitada"],
            rating: 4.9,
            reviews: 512
        },
        {
            id: 10,
            name: "Playstation 3 Desbloqueado, HD 500GB - 200 JOGOS + 2 Controles Sistema Hen",
            category: "Eletrônicos",
            oldPrice: 700.00,
            price: 350.00,
            pixString: "00020126580014BR.GOV.BCB.PIX01361c729f04-a046-4310-bdf5-1ead5d34bfc55204000053039865406350.005802BR5925Wendel dos Santos Oliveir6009SAO PAULO62140510krdX6asqzO63042C6F",
            paymentLink: "https://nubank.com.br/cobrar/1ku07b/695cac92-c5b4-4caf-8499-ed8c7f2480b2",
            images: [
                "https://img.olx.com.br/images/80/808570119282306.jpg",
                "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQBNkeeTHNQZ_stpbbVAIjOv4o9mJ4Eu5i50bxx5wz0pjqpMapVLbqZ5yJp&s=10"
            ],
            desc: "Clássico da Sony com desbloqueio HEN. Jogue online e offline com qualidade HDMI. Acompanha cabos e controles sem fio.",
            options: ["Slim", "Super Slim"],
            rating: 4.8,
            reviews: 340
        },
        {
            id: 11,
            name: "Playstation 2 (PS2) DESBLOQUEADO + OPL + 2 Controles 250 JOGOS + HD 1TB",
            category: "Eletrônicos",
            oldPrice: 450.00,
            price: 200.00,
            pixString: "00020126580014BR.GOV.BCB.PIX01361c729f04-a046-4310-bdf5-1ead5d34bfc55204000053039865406200.005802BR5925Wendel dos Santos Oliveir6009SAO PAULO62140510djGbzWJHyN6304E0BB",
            paymentLink: "https://nubank.com.br/cobrar/1ku07b/695cacba-f42d-46a4-ad7e-45cbc15ed409",
            images: [
                "https://img.olx.com.br/images/80/808570119282306.jpg",
                "https://cdn.awsli.com.br/2500x2500/2598/2598981/produto/298584501/bf2d530b35cb0dbeeca9ca3e565df847-bwibgsimh6.jpg",
                "https://img.olx.com.br/images/32/327517830661099.jpg"
            ],
            desc: "O rei dos consoles! Sistema OPL configurado no HD de 1TB. Carregamento rápido de jogos e nostalgia pura.",
            options: ["Preto", "Prata"],
            rating: 5.0,
            reviews: 1200
        },
        {
            id: 12,
            name: "Playstation 1 Original na caixa+ 2 Controles + 200 jogos",
            category: "Eletrônicos",
            oldPrice: 400.00,
            price: 200.00,
            pixString: "00020126580014BR.GOV.BCB.PIX01361c729f04-a046-4310-bdf5-1ead5d34bfc55204000053039865406200.005802BR5925Wendel dos Santos Oliveir6009SAO PAULO62140510djGbzWJHyN6304E0BB",
            paymentLink: "https://nubank.com.br/cobrar/1ku07b/695cacba-f42d-46a4-ad7e-45cbc15ed409",
            images: [
                "https://img.olx.com.br/thumbs700x500/51/515546438522211.webp"
            ],
            desc: "Item de colecionador. Console conservado na caixa original. Acompanha jogos clássicos e controles originais.",
            options: ["Cinza Clássico"],
            rating: 5.0,
            reviews: 150
        }
    ];

    // --- VARIÁVEIS GLOBAIS ---
    let currentProduct = null;
    let wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
    let purchasedItems = JSON.parse(localStorage.getItem('purchasedItems')) || [];
    let userReviews = JSON.parse(localStorage.getItem('userReviews')) || {}; 
    let isAscending = false;
    let selectedVariant = null;
    let selectedRating = 0;
    let slideIndex = 0;

    // --- INICIALIZAÇÃO ---
    function confirmAge() {
        document.getElementById('age-modal').classList.add('hidden');
        document.getElementById('app').classList.remove('hidden');
        
        injectCustomStyles(); // Injeta CSS do carrosel
        renderCustomHomeElements(); // Injeta HTML do Carrosel e Banner
        
        renderProducts(products); 
        startTimer('main-timer', 20);
        loadUserData();
    }

    // --- LÓGICA DO CARROSEL E BANNER ---
    function injectCustomStyles() {
        const style = document.createElement('style');
        style.innerHTML = `
            .custom-carousel-container { position: relative; max-width: 100%; margin: 10px; overflow: hidden; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
            .carousel-slide { display: none; width: 100%; height: 200px; position: relative; background: #fff; cursor: pointer; }
            .carousel-slide img { width: 100%; height: 100%; object-fit: cover; }
            .carousel-caption { position: absolute; bottom: 0; left: 0; width: 100%; background: linear-gradient(transparent, rgba(0,0,0,0.8)); color: white; padding: 10px; }
            .carousel-badge { position: absolute; top: 10px; right: 10px; background: #ff5000; color: white; padding: 5px 10px; font-weight: bold; border-radius: 4px; font-size: 0.8rem; animation: pulse 1s infinite; }
            .xbox-banner { margin: 10px; background: linear-gradient(45deg, #107C10, #3A9D23); color: white; padding: 15px; border-radius: 8px; display: flex; align-items: center; justify-content: space-between; cursor: pointer; box-shadow: 0 4px 10px rgba(16, 124, 16, 0.4); }
            .xbox-banner img { width: 80px; height: 80px; object-fit: cover; border-radius: 50%; border: 3px solid white; }
            .xbox-info { flex: 1; padding-left: 15px; }
            .xbox-btn { background: white; color: #107C10; padding: 8px 15px; border-radius: 20px; font-weight: bold; border: none; font-size: 0.8rem; }
            .fade { animation-name: fade; animation-duration: 1.5s; }
            @keyframes fade { from {opacity: .4} to {opacity: 1} }
        `;
        document.head.appendChild(style);
    }

    function renderCustomHomeElements() {
        const heroBanner = document.querySelector('.hero-banner');
        if(!heroBanner) return;

        // 1. Criar e Inserir Carrossel (PS2, PS3, Makita)
        // IDs: Makita(7), PS3(10), PS2(11)
        const promoIds = [11, 10, 7]; 
        let slidesHtml = '';
        
        promoIds.forEach(id => {
            const p = products.find(x => x.id === id);
            if(p) {
                slidesHtml += `
                    <div class="carousel-slide fade" onclick="openProduct(${p.id})">
                        <div class="carousel-badge">OFERTA RELÂMPAGO ⚡</div>
                        <img src="${p.images[0]}" alt="${p.name}">
                        <div class="carousel-caption">
                            <h3 style="font-size: 1rem; margin-bottom: 2px;">${p.name}</h3>
                            <span style="background: yellow; color: black; padding: 2px 5px; font-weight: bold; border-radius: 2px;">R$ ${p.price.toFixed(2)}</span>
                        </div>
                    </div>
                `;
            }
        });

        const carouselContainer = document.createElement('div');
        carouselContainer.className = 'custom-carousel-container';
        carouselContainer.innerHTML = slidesHtml;

        // Inserir APÓS o Hero Banner original
        heroBanner.parentNode.insertBefore(carouselContainer, heroBanner.nextSibling);

        // 2. Criar e Inserir Banner Xbox 360 (ID 9)
        const xbox = products.find(x => x.id === 9);
        if(xbox) {
            const xboxBanner = document.createElement('div');
            xboxBanner.className = 'xbox-banner';
            xboxBanner.onclick = () => openProduct(xbox.id);
            xboxBanner.innerHTML = `
                <img src="${xbox.images[0]}" alt="Xbox">
                <div class="xbox-info">
                    <h3 style="margin:0; font-size: 1.1rem;">Mais Vendido! 🔥</h3>
                    <p style="font-size: 0.85rem; margin: 5px 0;">${xbox.name.substring(0, 25)}...</p>
                    <span style="font-size: 1.2rem; font-weight: 900;">R$ ${xbox.price.toFixed(2)}</span>
                </div>
                <button class="xbox-btn">VER</button>
            `;
            // Inserir APÓS o Carrosel
            carouselContainer.parentNode.insertBefore(xboxBanner, carouselContainer.nextSibling);
        }

        showSlides(); // Inicia animação
    }

    function showSlides() {
        let i;
        let slides = document.getElementsByClassName("carousel-slide");
        if(slides.length === 0) return;
        
        for (i = 0; i < slides.length; i++) {
            slides[i].style.display = "none";  
        }
        slideIndex++;
        if (slideIndex > slides.length) {slideIndex = 1}    
        slides[slideIndex-1].style.display = "block";  
        setTimeout(showSlides, 3500); // Muda a cada 3.5 segundos
    }

    // --- FUNÇÕES CORE (Renderização) ---
    function renderProducts(list) {
        const container = document.getElementById('product-container');
        if(list.length === 0) {
            container.innerHTML = '<div style="grid-column: span 2; text-align:center; padding: 20px;">Nenhum produto encontrado.</div>';
            return;
        }
        container.innerHTML = list.map(p => {
            const isLiked = wishlist.includes(p.id) ? 'liked' : '';
            const heartIcon = isLiked ? 'fas' : 'far';
            return `
            <div class="product-card">
                <div class="card-heart ${isLiked}" onclick="toggleWishlist(${p.id}, event)">
                    <i class="${heartIcon} fa-heart"></i>
                </div>
                <div onclick="openProduct(${p.id})">
                    <div class="p-img-container">
                        <span class="discount-tag">-50%</span>
                        <img src="${p.images[0]}" alt="${p.name}">
                    </div>
                    <div class="p-info">
                        <div class="p-name">${p.name}</div>
                        <div class="stars">${getStars(p.rating)} (${p.reviews})</div>
                        <div><span class="strike">R$ ${p.oldPrice.toFixed(2).replace('.', ',')}</span></div>
                        <div class="flex" style="justify-content: space-between; align-items: center;">
                            <span class="price-tag">R$ ${p.price.toFixed(2).replace('.', ',')}</span>
                            <span class="sold-count"><i class="fas fa-fire"></i> 2mil+ vend.</span>
                        </div>
                    </div>
                </div>
            </div>
        `}).join('');
    }

    function getStars(rating) {
        let stars = '';
        for(let i=0; i<5; i++) {
            if(i < Math.floor(rating)) stars += '<i class="fas fa-star"></i>';
            else stars += '<i class="far fa-star"></i>';
        }
        return stars;
    }

    // --- PESQUISA E FILTROS ---
    function searchProducts(query) {
        const filtered = products.filter(p => p.name.toLowerCase().includes(query.toLowerCase()));
        renderProducts(filtered);
        document.getElementById('list-title').innerHTML = query ? `Resultados para "${query}"` : 'Mais Vendidos do Dia <i class="fas fa-fire text-primary"></i>';
    }
    function filterCategory(category) {
        document.getElementById('searchInput').value = ''; 
        const filtered = products.filter(p => p.category === category);
        renderProducts(filtered);
        document.getElementById('list-title').innerHTML = `Categoria: ${category}`;
    }
    function resetFilters() {
        document.getElementById('searchInput').value = '';
        renderProducts(products);
        document.getElementById('list-title').innerHTML = 'Mais Vendidos do Dia <i class="fas fa-fire text-primary"></i>';
    }
    function toggleSort() {
        isAscending = !isAscending;
        const sorted = [...products].sort((a, b) => {
            return isAscending ? a.name.localeCompare(b.name) : b.name.localeCompare(a.name);
        });
        renderProducts(sorted);
        alert(isAscending ? "Ordenado de A-Z" : "Ordenado de Z-A");
    }

    // --- WISHLIST ---
    function toggleWishlist(id, event) {
        if(event) event.stopPropagation(); 
        if(wishlist.includes(id)) { wishlist = wishlist.filter(item => item !== id); } 
        else { wishlist.push(id); }
        localStorage.setItem('wishlist', JSON.stringify(wishlist));
        if(!document.getElementById('wishlist-view').classList.contains('hidden')){ renderWishlist(); } 
        else { 
            const currentSearch = document.getElementById('searchInput').value;
            if(currentSearch) searchProducts(currentSearch);
            else renderProducts(products);
        }
    }
    function renderWishlist() {
        const container = document.getElementById('wishlist-container');
        const emptyMsg = document.getElementById('empty-wishlist-msg');
        if(wishlist.length === 0) {
            container.innerHTML = '';
            emptyMsg.classList.remove('hidden');
            return;
        }
        emptyMsg.classList.add('hidden');
        const wishProducts = products.filter(p => wishlist.includes(p.id));
        container.innerHTML = wishProducts.map(p => `
            <div class="product-card">
                 <div class="card-heart liked" onclick="toggleWishlist(${p.id}, event)"><i class="fas fa-heart"></i></div>
                <div onclick="openProduct(${p.id})">
                    <div class="p-img-container"><img src="${p.images[0]}" alt="${p.name}"></div>
                    <div class="p-info">
                        <div class="p-name">${p.name}</div>
                         <div class="flex" style="justify-content: space-between; align-items: center;">
                            <span class="price-tag">R$ ${p.price.toFixed(2).replace('.', ',')}</span>
                        </div>
                         <button class="btn btn-primary" style="margin-top:5px; padding: 5px; font-size:0.8rem;">Comprar</button>
                    </div>
                </div>
            </div>
        `).join('');
    }

    // --- NAVEGAÇÃO ---
    function switchTab(tab) {
        document.querySelectorAll('.view-section').forEach(el => el.classList.add('hidden'));
        document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
        document.getElementById('product-view').classList.add('hidden');
        document.getElementById('checkout-form-view').classList.add('hidden');
        document.getElementById('payment-view').classList.add('hidden');
        if(tab === 'home') {
            document.getElementById('home-view').classList.remove('hidden');
            document.getElementById('nav-home').classList.add('active');
            renderProducts(products); 
        } else if (tab === 'wish') {
            document.getElementById('wishlist-view').classList.remove('hidden');
            document.getElementById('nav-wish').classList.add('active');
            renderWishlist();
        } else if (tab === 'profile') {
            document.getElementById('profile-view').classList.remove('hidden');
            document.getElementById('nav-profile').classList.add('active');
            updateProfileUI();
        }
        window.scrollTo(0,0);
    }

    // --- DETALHES DO PRODUTO ---
    function goBackToHome() {
        document.getElementById('product-view').classList.add('hidden');
        document.body.style.overflow = 'auto'; 
    }
    function openProduct(id) {
        currentProduct = products.find(p => p.id === id);
        selectedVariant = null; 
        const view = document.getElementById('product-view');
        const content = document.getElementById('product-content');
        const isLiked = wishlist.includes(id);
        const hasPurchased = purchasedItems.includes(id);

        let thumbsHtml = currentProduct.images.map((img, idx) => 
            `<img src="${img}" class="thumb ${idx===0?'active':''}" onclick="changeMainImage(this.src, this)">`
        ).join('');
        let optionsHtml = currentProduct.options.map(opt => 
            `<button class="option-btn" onclick="selectOption(this, '${opt}')">${opt}</button>`
        ).join('');
        const related = products.filter(p => p.id !== currentProduct.id).sort(() => 0.5 - Math.random()).slice(0, 4);
        let relatedHtml = related.map(rp => `
            <div class="product-card" onclick="openProduct(${rp.id});">
                <div class="p-img-container"><span class="discount-tag">-50%</span><img src="${rp.images[0]}" alt="${rp.name}"></div>
                <div class="p-info">
                    <div class="p-name" style="font-size: 0.8rem;">${rp.name}</div>
                    <span class="price-tag" style="font-size: 1rem;">R$ ${rp.price.toFixed(2).replace('.', ',')}</span>
                </div>
            </div>
        `).join('');

        const fakeReviews = [
            { name: "Maria S.", text: "Amei o produto! Chegou antes do prazo.", date: "Há 2 dias", stars: 5 },
            { name: "Carlos A.", text: "Muito bom, exatamente como na foto.", date: "Há 1 semana", stars: 5 },
            { name: "João P.", text: "Produto top! Veio bem embalado.", date: "Há 1 mês", stars: 5 }
        ];
        const savedReviews = userReviews[id] || [];
        const allReviews = [...savedReviews, ...fakeReviews];

        let reviewsHtml = allReviews.map(r => `
            <div class="review-card">
                <div class="review-header">
                    <div class="user-avatar"><i class="fas fa-user"></i></div>
                    <div class="user-name">${r.name}</div>
                    <div style="color: #ffc107; font-size: 0.8rem;">${getStars(r.stars)}</div>
                    <span class="review-date">${r.date}</span>
                </div>
                <p style="font-size: 0.9rem; color: #555;">${r.text}</p>
            </div>
        `).join('');

        content.innerHTML = `
            <img id="main-prod-img" src="${currentProduct.images[0]}" class="main-image">
            <div class="thumbs">${thumbsHtml}</div>
            <div class="p-details">
                <div class="official-sponsor" style="background:transparent; padding:0; justify-content:flex-start; margin-bottom:10px; border:none;">
                     <span style="font-size:0.7rem; color: var(--primary); font-weight:bold;">Shopee Garantia <i class="fas fa-shield-alt"></i></span>
                </div>
                <div class="flex" style="justify-content: space-between; align-items: flex-start;">
                    <h1 style="font-size: 1.2rem; width: 70%; line-height: 1.3;">${currentProduct.name}</h1>
                    <div style="text-align: right;">
                         <span class="strike">R$ ${currentProduct.oldPrice.toFixed(2).replace('.', ',')}</span><br>
                         <span class="price-tag" style="font-size: 1.8rem;">R$ ${currentProduct.price.toFixed(2).replace('.', ',')}</span>
                    </div>
                </div>
                <div style="color: #ffc107; font-size: 0.9rem; margin: 10px 0;">${getStars(currentProduct.rating)} ${currentProduct.rating} | ${currentProduct.reviews} Avaliações</div>
                <div style="margin: 15px 0;">
                    <p style="font-weight: bold; margin-bottom: 5px;">Escolha a variação:</p>
                    <div style="display: flex; flex-wrap: wrap;">${optionsHtml}</div>
                    <p id="var-error" style="color: red; font-size: 0.8rem; display: none; margin-top:5px;">* Por favor, selecione uma opção antes de comprar.</p>
                </div>
                <div class="shipping-info">
                    <i class="fas fa-truck text-primary"></i>
                    <div><strong>Frete Grátis Shopee Xpress</strong><br>Chega entre 2 a 5 dias úteis (Full)</div>
                </div>
                <div style="margin: 20px 0; font-size: 0.9rem; color: #444; line-height: 1.5;">
                    <h3 style="margin-bottom: 10px;">Descrição</h3><p>${currentProduct.desc}</p>
                </div>
                <div class="reviews-box">
                    <div class="flex" style="justify-content: space-between; align-items: center; margin-bottom: 10px;"><h3>Avaliações</h3></div>
                    <div id="review-list">${reviewsHtml}</div>
                    ${!hasPurchased ? `<button class="btn btn-secondary" style="margin-top: 15px;" onclick="alert('Você precisa comprar este produto para deixar uma avaliação!')"><i class="fas fa-pen"></i> Deixar minha avaliação</button>` : `<button class="btn btn-secondary" style="margin-top: 15px;" onclick="document.getElementById('review-form').classList.remove('hidden'); this.style.display='none';"><i class="fas fa-pen"></i> Avaliar Produto</button><div id="review-form" class="hidden"><h4>Escreva sua avaliação</h4><div style="margin: 10px 0;"><i class="fas fa-star star-select" onclick="setRate(1)" id="star-1"></i><i class="fas fa-star star-select" onclick="setRate(2)" id="star-2"></i><i class="fas fa-star star-select" onclick="setRate(3)" id="star-3"></i><i class="fas fa-star star-select" onclick="setRate(4)" id="star-4"></i><i class="fas fa-star star-select" onclick="setRate(5)" id="star-5"></i></div><textarea id="review-text" rows="3" placeholder="O que achou do produto?"></textarea><button class="btn btn-primary" onclick="submitReview()">Enviar Avaliação</button></div>`}
                </div>
                <div class="related-box"><h3 style="margin-bottom: 15px;">Você também pode gostar</h3><div class="product-grid" style="grid-template-columns: repeat(2, 1fr); padding: 0;">${relatedHtml}</div></div>
            </div>
            <div style="position: fixed; bottom: 0; left: 0; width: 100%; background: white; padding: 10px; box-shadow: 0 -2px 10px rgba(0,0,0,0.1); display: flex; gap: 10px; z-index: 201;">
                <button class="btn btn-secondary" style="width: 50px; font-size: 1.2rem; color: ${isLiked ? 'var(--secondary)' : '#333'}" onclick="toggleWishlist(${currentProduct.id}); openProduct(${currentProduct.id})"><i class="${isLiked ? 'fas' : 'far'} fa-heart"></i></button>
                <button class="btn btn-primary" onclick="goToCheckout()">COMPRAR AGORA</button>
            </div>
        `;
        view.classList.remove('hidden');
        document.body.style.overflow = 'hidden'; 
        view.scrollTop = 0; 
    }
    function changeMainImage(src, el) { document.getElementById('main-prod-img').src = src; document.querySelectorAll('.thumb').forEach(t => t.classList.remove('active')); el.classList.add('active'); }
    function selectOption(btn, value) { document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected')); btn.classList.add('selected'); selectedVariant = value; document.getElementById('var-error').style.display = 'none'; }
    function setRate(star) { selectedRating = star; for(let i=1; i<=5; i++) { const el = document.getElementById(`star-${i}`); if(i <= star) el.classList.add('active'); else el.classList.remove('active'); } }
    function submitReview() {
        if(selectedRating === 0) { alert("Selecione uma nota em estrelas."); return; }
        const text = document.getElementById('review-text').value;
        if(!text) { alert("Escreva um comentário."); return; }
        const userData = JSON.parse(localStorage.getItem('user_data')) || { name: "Cliente" };
        const newReview = { name: userData.name, text: text, date: "Agora", stars: selectedRating };
        if(!userReviews[currentProduct.id]) userReviews[currentProduct.id] = [];
        userReviews[currentProduct.id].unshift(newReview);
        localStorage.setItem('userReviews', JSON.stringify(userReviews));
        alert("Avaliação enviada com sucesso!");
        openProduct(currentProduct.id); 
    }

    // --- CHECKOUT E PAGAMENTO ---
    function loadUserData() {
        const savedData = JSON.parse(localStorage.getItem('user_data'));
        if (savedData) {
            document.getElementById('fname').value = savedData.name || '';
            document.getElementById('fcpf').value = savedData.cpf || '';
            document.getElementById('fcep').value = savedData.cep || '';
            document.getElementById('faddr').value = savedData.addr || '';
            document.getElementById('fnum').value = savedData.num || '';
            document.getElementById('fbairro').value = savedData.bairro || '';
            document.getElementById('fcity').value = savedData.city || '';
            document.getElementById('fref').value = savedData.ref || '';
        }
    }
    function updateProfileUI() {
        const savedData = JSON.parse(localStorage.getItem('user_data'));
        const historyContainer = document.getElementById('history-container');
        if (savedData) {
            document.getElementById('profile-name-display').innerText = savedData.name;
            document.getElementById('display-cpf').innerText = savedData.cpf;
            document.getElementById('display-addr').innerText = savedData.addr + ', ' + savedData.cep;
            document.getElementById('display-num').innerText = savedData.num;
            document.getElementById('display-bairro').innerText = savedData.bairro;
            document.getElementById('display-city').innerText = savedData.city;
        }
        if(purchasedItems.length > 0) {
            const myProducts = products.filter(p => purchasedItems.includes(p.id));
            historyContainer.innerHTML = myProducts.map(p => `
                <div class="history-item">
                    <img src="${p.images[0]}" class="history-img">
                    <div>
                        <div style="font-weight:bold; font-size:0.9rem;">${p.name}</div>
                        <div style="font-size:0.8rem; color: green;"><i class="fas fa-box"></i> Preparando Envio</div>
                        <button class="btn-secondary" style="padding:2px 8px; font-size:0.7rem; margin-top:5px;" onclick="switchTab('home'); openProduct(${p.id})">Comprar Novamente</button>
                    </div>
                </div>
            `).join('');
        } else { historyContainer.innerHTML = '<p style="font-size: 0.9rem; color: #777;">Nenhum pedido recente.</p>'; }
    }
    function goToCheckout() {
        if(!selectedVariant && currentProduct.options.length > 0) {
            document.getElementById('var-error').style.display = 'block';
            document.getElementById('product-view').scrollTo({ top: 200, behavior: 'smooth' });
            return;
        }
        loadUserData(); 
        document.getElementById('checkout-product-name').innerText = currentProduct.name;
        document.getElementById('checkout-variant').innerText = selectedVariant ? `Opção: ${selectedVariant}` : '';
        const priceFormatted = currentProduct.price.toFixed(2).replace('.', ',');
        document.getElementById('checkout-subtotal').innerText = `R$ ${priceFormatted}`;
        document.getElementById('checkout-total').innerText = `R$ ${priceFormatted}`;
        document.getElementById('checkout-form-view').classList.remove('hidden');
    }
    function goBackToProduct() { document.getElementById('checkout-form-view').classList.add('hidden'); }
    function submitForm(e) {
        e.preventDefault();
        const userData = {
            name: document.getElementById('fname').value,
            cpf: document.getElementById('fcpf').value,
            cep: document.getElementById('fcep').value,
            addr: document.getElementById('faddr').value,
            num: document.getElementById('fnum').value,
            bairro: document.getElementById('fbairro').value,
            city: document.getElementById('fcity').value,
            ref: document.getElementById('fref').value
        };
        localStorage.setItem('user_data', JSON.stringify(userData));
        document.getElementById('confirm-address-text').innerHTML = `<strong><i class="fas fa-check text-primary"></i> Endereço para entrega:</strong><br>${userData.addr}, ${userData.num}<br>${userData.bairro} - ${userData.city}<br>CEP: ${userData.cep}`;
        document.getElementById('checkout-form-view').classList.add('hidden');
        document.getElementById('loading-view').classList.remove('hidden');
        
        const pixStringCode = currentProduct.pixString;
        const linkPayment = currentProduct.paymentLink;
        document.getElementById('pix-string').innerText = pixStringCode;
        document.getElementById('payment-link-btn').href = linkPayment;
        const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(pixStringCode)}`;
        document.getElementById('qr-image').src = qrUrl;

        setTimeout(() => {
            document.getElementById('loading-view').classList.add('hidden');
            document.getElementById('payment-view').classList.remove('hidden');
            startTimer('pix-timer', 0.25); 
        }, 2500);
    }
    function activateLocation() {
        const btn = document.getElementById('btn-gps');
        const status = document.getElementById('map-status');
        btn.innerHTML = '<div class="spinner" style="width:15px; height:15px; border-width:2px; display:inline-block; margin-bottom:0;"></div> Localizando...';
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(
                (position) => {
                    setTimeout(() => {
                         btn.style.display = 'none';
                         status.innerHTML = `<span style="color:green; font-weight:bold;">${position.coords.latitude.toFixed(4)}, ${position.coords.longitude.toFixed(4)}</span>`;
                         document.getElementById('gps-msg').style.display = 'block';
                         document.getElementById('map-area').style.border = "2px solid #00bfa5";
                    }, 1500);
                },
                (error) => {
                    setTimeout(() => {
                         btn.style.display = 'none';
                         status.innerHTML = `<span style="color:#00416B; font-weight:bold;">CEP Localizado com Sucesso.</span>`;
                         document.getElementById('gps-msg').innerHTML = "<i class='fas fa-check'></i> Localização validada pelo CEP.";
                         document.getElementById('gps-msg').style.display = 'block';
                    }, 1000);
                }
            );
        } else { alert("GPS não suportado, usaremos o CEP."); }
    }
    function confirmPurchase() {
        if(!purchasedItems.includes(currentProduct.id)) {
            purchasedItems.push(currentProduct.id);
            localStorage.setItem('purchasedItems', JSON.stringify(purchasedItems));
        }
        alert("Pagamento em análise! Você receberá a confirmação por e-mail em instantes.");
        window.location.reload(); 
    }
    function clearUserData() {
        if(confirm("Tem certeza que deseja apagar seus dados salvos?")) {
            localStorage.removeItem('user_data');
            localStorage.removeItem('purchasedItems');
            purchasedItems = [];
            updateProfileUI();
            alert("Dados limpos com sucesso.");
        }
    }
    function copyPix() {
        const code = document.getElementById('pix-string').innerText;
        navigator.clipboard.writeText(code).then(() => { alert('Código Pix copiado! Cole no app do seu banco.'); });
    }
    function startTimer(elementId, hours) {
        let time = hours * 3600;
        const display = document.getElementById(elementId);
        if(window['timer_'+elementId]) clearInterval(window['timer_'+elementId]);
        window['timer_'+elementId] = setInterval(() => {
            let h = Math.floor(time / 3600);
            let m = Math.floor((time % 3600) / 60);
            let s = time % 60;
            h = h < 10 ? '0'+h : h; m = m < 10 ? '0'+m : m; s = s < 10 ? '0'+s : s;
            if(display) display.innerText = `${h}:${m}:${s}`;
            time--;
            if (time < 0) clearInterval(window['timer_'+elementId]);
        }, 1000);
    }
</script>

</script>

</script>
<script>
    // --- ATUALIZAÇÃO DE ESTOQUE (NOVOS PRODUTOS) ---
    // Adiciona os novos itens à lista 'products' original sem apagar os antigos.
    
    products.push(
        {
            id: 13,
            name: "Geladeira Refrigerador HQ Defrost 230 Litros Branco HQ-230RDF 127V",
            category: "Casa",
            oldPrice: 1899.00,
            price: 450.00,
            pixString: "00020126580014BR.GOV.BCB.PIX0136fe318421-7a48-4290-a401-7abcc31b761e5204000053039865406450.005802BR5924Miria Silva da Conceicao6009SAO PAULO62140510AyJNDzSSUK63041F58",
            paymentLink: "https://nubank.com.br/cobrar/e3a38i/696585d7-aac5-49d6-af16-ea772bef5a51",
            images: [
                "https://imgs.casasbahia.com.br/1571279699/1xg.jpg?imwidth=828",
                "https://imgs.casasbahia.com.br/1571279699/2xg.jpg?imwidth=828",
                "https://imgs.casasbahia.com.br/1571279699/3xg.jpg?imwidth=828",
                "https://imgs.casasbahia.com.br/1571279699/4xg.jpg?imwidth=828"
            ],
            desc: "Refrigerador HQ Defrost 230 Litros: Eficiência energética Classe A (Procel) com baixo consumo. Possui sistema Cycle Defrost para descongelamento prático, prateleiras removíveis e reguláveis em altura, além de um amplo gavetão para frutas e legumes. Design compacto ideal para cozinhas modernas, com termostato ajustável e gás ecológico R600a.",
            options: ["110V (127V)"],
            rating: 4.8,
            reviews: 110
        },
        {
            id: 14,
            name: "Forno Micro-ondas LG MS3043BR 30L com Função Manter Aquecido - Prata",
            category: "Casa",
            oldPrice: 899.00,
            price: 200.00,
            pixString: "00020126580014BR.GOV.BCB.PIX0136fe318421-7a48-4290-a401-7abcc31b761e5204000053039865406200.005802BR5924Miria Silva da Conceicao6009SAO PAULO62140510vkOe2fQM2b63042E36",
            paymentLink: "https://nubank.com.br/cobrar/e3a38i/69658615-474c-4b9e-a8b5-11b2c5384f34",
            images: [
                "https://imgs.casasbahia.com.br/55066686/1g.jpg?imwidth=828",
                "https://imgs.casasbahia.com.br/55066686/2g.jpg?imwidth=828",
                "https://imgs.casasbahia.com.br/55066686/3g.jpg?imwidth=828"
            ],
            desc: "Tecnologia e Praticidade. Micro-ondas LG 30 Litros com revestimento EasyClean™ antibacteriano que elimina 99,99% das bactérias e facilita a limpeza (a gordura não gruda). Possui tecnologia I-Wave para cozimento e descongelamento uniforme dos alimentos. Função Eco On para economia de energia e trava de segurança para crianças.",
            options: ["110V"],
            rating: 4.9,
            reviews: 340
        },
        {
            id: 15,
            name: "Apple iPhone 14 128GB Meia-noite - Tela 6,1\" 12MP",
            category: "Eletrônicos",
            oldPrice: 4500.00,
            price: 950.00,
            pixString: "00020126580014BR.GOV.BCB.PIX0136fe318421-7a48-4290-a401-7abcc31b761e5204000053039865406950.005802BR5924Miria Silva da Conceicao6009SAO PAULO62140510gAy2v5XwoT63044EDE",
            paymentLink: "https://nubank.com.br/cobrar/e3a38i/6965865b-eb1e-4f4b-b033-88258f0c5af7",
            images: [
                "https://imgs.casasbahia.com.br/55058313/1g.jpg?imwidth=828",
                "https://imgs.casasbahia.com.br/55058313/2g.jpg?imwidth=828",
                "https://imgs.casasbahia.com.br/55058313/3g.jpg?imwidth=828"
            ],
            desc: "Potência em suas mãos. Chip A15 Bionic com GPU de 5 núcleos para desempenho ultrarrápido. Sistema de câmera avançado com Photonic Engine para fotos incríveis em pouca luz. Modo Ação para vídeos estáveis em movimento e Modo Cinema 4K Dolby Vision. Tela Super Retina XDR com Ceramic Shield e Detecção de Acidente.",
            options: ["Meia-noite (Preto)"],
            rating: 5.0,
            reviews: 890
        },
        {
            id: 16,
            name: "iPhone 13 128GB Meia Noite - Muito Bom (Vitrine)",
            category: "Eletrônicos",
            oldPrice: 3200.00,
            price: 600.00,
            pixString: "00020126580014BR.GOV.BCB.PIX0136fe318421-7a48-4290-a401-7abcc31b761e5204000053039865406600.005802BR5924Miria Silva da Conceicao6009SAO PAULO621405108mlGNOoJHr6304AC11",
            paymentLink: "https://nubank.com.br/cobrar/e3a38i/69658694-0027-4740-a166-c322da3d17a2",
            images: [
                "https://imgs.casasbahia.com.br/1566773795/1xg.jpg?imwidth=828",
                "https://imgs.casasbahia.com.br/1566773795/2xg.jpg?imwidth=828",
                "https://imgs.casasbahia.com.br/1566773795/4xg.jpg?imwidth=828"
            ],
            desc: "O clássico moderno. Tela Super Retina XDR de 6,1 polegadas. Chip A15 Bionic. Sistema avançado de câmera dupla de 12 MP (Wide e Ultra Wide) com Estilos Fotográficos e Smart HDR 4. Bateria de longa duração e resistência à água IP68. Aparelho em estado de 'Muito Bom', rigorosamente testado.",
            options: ["Meia-noite"],
            rating: 4.9,
            reviews: 520
        }
    );
</script>
<script>
    /* --- SCRIPT DE ATUALIZAÇÃO "PREMIUM" --- 
       Este código roda logo após o script original, atualizando os dados 
       e adicionando as novas funcionalidades sem quebrar o site.
    */

    // 1. DICIONÁRIO DE DESCRIÇÕES AVANÇADAS (Para os produtos originais ID 1-12)
    // Atualiza os textos simples para "Copywriting" de alta conversão.
    const newDescriptions = {
        1: "Equipamento tático de elite. Confeccionada em Nylon Oxford 900D de alta densidade, esta mochila é totalmente impermeável e resistente a rasgos. Possui sistema MOLLE para acoplagem de módulos, costuras duplas reforçadas, encosto respirável e compartimentos organizadores inteligentes. Ideal para missões, camping, trilhas pesadas ou uso diário robusto.",
        2: "A ferramenta definitiva para o profissional. Motor Brushless de alto torque que não precisa de manutenção. O kit acompanha maleta rígida industrial, duas baterias de Lítio 48V de longa duração (carregamento rápido) e jogo de bits em aço cromo-vanádio. Possui luz LED integrada, 25 níveis de torque e função martelete para perfurar concreto com facilidade.",
        3: "Símbolo de status e sofisticação. Relógio de movimento Quartzo Suíço de alta precisão. Banhado a ouro 18k através de processo de galvanoplastia que garante brilho eterno e não descasca. Cravejado manualmente com pedras de Zircônia Cúbica AAA+ que simulam o brilho real de diamantes. Vidro de safira resistente a riscos e prova d'água 3ATM.",
        4: "Mobilidade urbana com estilo. Equipado com bateria Samsung original de células premium que garante autonomia de até 20km. Possui giroscópio de última geração para auto-equilíbrio instantâneo, rodas de 6.5 polegadas maciças (antifuro), conectividade Bluetooth para tocar suas músicas e iluminação LED RGB nos para-lamas e rodas.",
        5: "Peça de colecionador nível 'Masterlise'. Escultura em PVC de alta fidelidade com 18cm de altura. Pintura sombreada com texturas realistas que destacam a musculatura e as expressões faciais. Acompanha base de suporte exclusiva. Produto original importado, perfeito para setups gamers e estantes de colecionadores exigentes.",
        6: "O básico de luxo que você merece. Kit com camisetas 'Oversized' produzidas em Algodão Egípcio fio 30.1 penteado. Tecnologia Anti-Pilling (não cria bolinhas), não desbota e não encolhe na lavagem. Toque aveludado, gola reforçada com ribana canelada e caimento perfeito no corpo. Estilo Streetwear minimalista.",
        7: "Potência bruta para construção civil. A Serra Mármore mais confiável do mercado. Motor de 1300W blindado contra poeira, capaz de operar por horas contínuas. Realiza cortes precisos em mármore, granito, concreto, alvenaria e cerâmica. Acompanha chave de aperto, mangueira para corte úmido e garantia estendida de uso profissional.",
        8: "Eficiência e elegância para seu ambiente. Frigobar com compressor de alta performance e baixo ruído (apenas 40dB). Classificação energética A (Procel). Possui congelador separado, porta reversível, prateleiras de vidro temperado ajustáveis e compartimento para latas. Ideal para escritórios, quartos de hotel, áreas gourmet e dormitórios.",
        9: "O Clássico turbinado. Console Xbox 360 Super Slim com desbloqueio RGH 3.0 (boot instantâneo). Acompanha HD interno lotado com os maiores clássicos da geração, emuladores (SNES, Mega Drive, Arcade) e interface Aurora personalizada. Sistema de resfriamento modificado para evitar superaquecimento. Diversão infinita pronta para jogar.",
        10: "Central de entretenimento completa. PlayStation 3 Super Slim com desbloqueio HEN atualizado. Permite jogar online, assistir YouTube e Netflix. Leitor Blu-Ray funcional. Acompanha loja PKGi instalada para baixar jogos direto no console via Wi-Fi grátis. Controles DualShock 3 com precisão original e bateria nova.",
        11: "A lenda imortal. PlayStation 2 revisado e higienizado. Leitor óptico novo + Sistema OPL configurado via USB/HD. Roda jogos direto do Pen Drive com carregamento super rápido, sem travar as 'CGs'. Acompanha Memory Card com FMCB (Free McBoot) para salvar progresso e usar cheats. O rei da nostalgia.",
        12: "Relíquia histórica preservada. PlayStation 1 (PSOne) modelo 'Baby', item de vitrine em estado de novo. Acompanha caixa original (reprodução), manuais e cabos. Leitor alinhado rodando discos prateados e dourados. Controles analógicos DualShock sem 'drift'. Uma viagem no tempo para os anos 90 com qualidade de imagem e som."
    };

    // 2. APLICA AS DESCRIÇÕES AVANÇADAS NOS PRODUTOS EXISTENTES
    products.forEach(p => {
        if(newDescriptions[p.id]) {
            p.desc = newDescriptions[p.id];
        }
    });

    // 3. ADICIONA OS NOVOS PRODUTOS (Com descrições já avançadas)
    const novosProdutos = [
        {
            id: 13,
            name: "Geladeira Refrigerador HQ Defrost 230L Branco Econômica",
            category: "Casa",
            oldPrice: 1899.00,
            price: 450.00,
            pixString: "00020126580014BR.GOV.BCB.PIX0136fe318421-7a48-4290-a401-7abcc31b761e5204000053039865406450.005802BR5924Miria Silva da Conceicao6009SAO PAULO62140510AyJNDzSSUK63041F58",
            paymentLink: "https://nubank.com.br/cobrar/e3a38i/696585d7-aac5-49d6-af16-ea772bef5a51",
            images: [
                "https://imgs.casasbahia.com.br/1571279699/1xg.jpg?imwidth=828",
                "https://imgs.casasbahia.com.br/1571279699/2xg.jpg?imwidth=828",
                "https://imgs.casasbahia.com.br/1571279699/3xg.jpg?imwidth=828"
            ],
            desc: "Tecnologia Cycle Defrost de ponta. Refrigerador HQ com eficiência energética Classe A, garantindo economia máxima na conta de luz. Possui design ergonômico 'Space Save', gavetão transparente para frutas que mantém a umidade natural, prateleiras removíveis para facilitar a limpeza e termostato de precisão. Gás ecológico R600a.",
            options: ["110V (127V)"],
            rating: 4.8, reviews: 110
        },
        {
            id: 14,
            name: "Forno Micro-ondas LG 30L EasyClean™ e I-Wave",
            category: "Casa",
            oldPrice: 899.00,
            price: 200.00,
            pixString: "00020126580014BR.GOV.BCB.PIX0136fe318421-7a48-4290-a401-7abcc31b761e5204000053039865406200.005802BR5924Miria Silva da Conceicao6009SAO PAULO62140510vkOe2fQM2b63042E36",
            paymentLink: "https://nubank.com.br/cobrar/e3a38i/69658615-474c-4b9e-a8b5-11b2c5384f34",
            images: [
                "https://imgs.casasbahia.com.br/55066686/1g.jpg?imwidth=828",
                "https://imgs.casasbahia.com.br/55066686/2g.jpg?imwidth=828"
            ],
            desc: "Cozinha Inteligente. Exclusiva tecnologia EasyClean™: revestimento especial que impede a gordura de grudar, permitindo limpeza apenas com água. Tecnologia I-Wave para cozimento e descongelamento uniforme (sem partes frias). Função Eco On (economiza energia em stand-by) e 16 receitas pré-programadas. Design espelhado premium.",
            options: ["110V - Prata"],
            rating: 4.9, reviews: 340
        },
        {
            id: 15,
            name: "iPhone 14 128GB Meia-noite | Chip A15 Bionic 5-Core",
            category: "Eletrônicos",
            oldPrice: 4500.00,
            price: 950.00,
            pixString: "00020126580014BR.GOV.BCB.PIX0136fe318421-7a48-4290-a401-7abcc31b761e5204000053039865406950.005802BR5924Miria Silva da Conceicao6009SAO PAULO62140510gAy2v5XwoT63044EDE",
            paymentLink: "https://nubank.com.br/cobrar/e3a38i/6965865b-eb1e-4f4b-b033-88258f0c5af7",
            images: [
                "https://imgs.casasbahia.com.br/55058313/1g.jpg?imwidth=828",
                "https://imgs.casasbahia.com.br/55058313/2g.jpg?imwidth=828"
            ],
            desc: "Superpotência Apple. Novo sistema de câmera dupla com Photonic Engine para fotos incríveis em pouca luz. Modo Ação para vídeos estáveis em movimento e Modo Cinema 4K Dolby Vision. Chip A15 Bionic com GPU de 5 núcleos para jogos pesados. Bateria para o dia todo e Detecção de Acidente vital. Tela Super Retina XDR OLED.",
            options: ["Meia-noite", "Estelar"],
            rating: 5.0, reviews: 890
        },
        {
            id: 16,
            name: "iPhone 13 128GB Vitrine (Estado de Novo) - Bateria 100%",
            category: "Eletrônicos",
            oldPrice: 3200.00,
            price: 600.00,
            pixString: "00020126580014BR.GOV.BCB.PIX0136fe318421-7a48-4290-a401-7abcc31b761e5204000053039865406600.005802BR5924Miria Silva da Conceicao6009SAO PAULO621405108mlGNOoJHr6304AC11",
            paymentLink: "https://nubank.com.br/cobrar/e3a38i/69658694-0027-4740-a166-c322da3d17a2",
            images: [
                "https://imgs.casasbahia.com.br/1566773795/1xg.jpg?imwidth=828",
                "https://imgs.casasbahia.com.br/1566773795/2xg.jpg?imwidth=828"
            ],
            desc: "Oportunidade Única. Aparelho de vitrine (Grade A+), sem marcas de uso, rigorosamente testado por técnicos certificados Apple. Bateria com 100% de saúde. Tela Super Retina XDR, Chip A15 Bionic, Câmera Dupla Avançada e 5G. Acompanha caixa, cabo Lightning e garantia da nossa loja de 90 dias.",
            options: ["Meia-noite"],
            rating: 4.9, reviews: 520
        }
    ];

    // Adiciona os novos produtos ao array principal se eles ainda não existirem
    novosProdutos.forEach(np => {
        if(!products.find(p => p.id === np.id)) {
            products.push(np);
        }
    });

    // 4. LÓGICA DE RANDOMIZAÇÃO (EMBARALHAR PRODUTOS)
    // Isso garante que toda vez que a página atualizar, a ordem seja diferente.
    function shuffleProducts() {
        for (let i = products.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [products[i], products[j]] = [products[j], products[i]];
        }
    }

    // Executa o embaralhamento imediatamente
    shuffleProducts();

</script>
<script>
    /** * --- ATUALIZAÇÃO MASTER GAMES TEC ---
     * Este script roda após o carregamento original para injetar
     * novas funcionalidades, produtos e segurança.
     */

    // ======================================================
    // 1. DADOS E PRODUTOS (ATUALIZADOS E NOVOS)
    // ======================================================
    
    // Descrições de Alta Conversão para produtos antigos
    const copyWritingDesc = {
        1: "Equipamento tático de elite. Nylon Oxford 900D impermeável, sistema MOLLE, costuras duplas e encosto respirável. Ideal para missões, camping ou uso diário robusto.",
        2: "Motor Brushless de alto torque. Acompanha maleta, 2 baterias Lítio 48V e bits em aço. Função martelete e luz LED. A ferramenta definitiva para o profissional.",
        3: "Movimento Quartzo Suíço banhado a ouro 18k. Cravejado com Zircônia Cúbica AAA+. Vidro de safira anti-risco. Um símbolo de status e sofisticação à prova d'água.",
        4: "Bateria Samsung original e auto-equilíbrio. Rodas 6.5\" maciças, Bluetooth integrado e LEDs RGB. Mobilidade urbana com segurança e estilo.",
        5: "Escultura 'Masterlise' em PVC (18cm). Pintura sombreada realista e texturas fiéis. Item de colecionador original importado para setups exigentes.",
        6: "Algodão Egípcio fio 30.1. Tecnologia Anti-Pilling (não dá bolinha) e não desbota. Caimento Oversized Streetwear com toque aveludado premium.",
        7: "Motor 1300W blindado. Corta mármore, granito e concreto com precisão. Acompanha kit refrigeração para corte úmido. Ferramenta para vida toda.",
        8: "Compressor silencioso (40dB) Classe A. Porta reversível e congelador separado. A elegância e eficiência que seu escritório ou quarto merecem.",
        9: "Desbloqueio RGH 3.0 (Boot instantâneo). HD cheio de jogos, emuladores e interface Aurora. Revisado com pasta térmica de prata. Ligar e jogar.",
        10: "Modelo Super Slim com HEN. Loja PKGi grátis (baixe jogos via Wi-Fi). Acompanha 1 controle original e cabos. Central multimídia completa.",
        11: "O Rei da Nostalgia. Leitor novo + Sistema OPL via USB. Roda jogos direto do Pen Drive. Acompanha Memory Card com FMCB configurado.",
        12: "Relíquia 'Baby' preservada. Leitor 100% alinhado. Acompanha caixa reprodução e controles analógicos. Item de vitrine para colecionadores."
    };

    // Novos Produtos
    const novosItens = [
        {
            id: 13, name: "Geladeira HQ Defrost 230L Econômica", category: "Casa", oldPrice: 1899, price: 450,
            pixString: "00020126580014BR.GOV.BCB.PIX0136fe318421-7a48-4290-a401-7abcc31b761e5204000053039865406450.005802BR5924Miria Silva da Conceicao6009SAO PAULO62140510AyJNDzSSUK63041F58",
            paymentLink: "https://nubank.com.br/cobrar/e3a38i/696585d7-aac5-49d6-af16-ea772bef5a51",
            images: ["https://imgs.casasbahia.com.br/1571279699/1xg.jpg?imwidth=828", "https://imgs.casasbahia.com.br/1571279699/2xg.jpg?imwidth=828"],
            desc: "✅ PRODUTO DE LOTE PROMOCIONAL.\nEficiência Classe A e sistema Cycle Defrost. Gavetão para frutas, prateleiras reguláveis e baixo consumo. Nova, na caixa, com garantia de funcionamento.",
            options: ["110V"], rating: 4.8, reviews: 110
        },
        {
            id: 14, name: "Micro-ondas LG 30L EasyClean™ Espelhado", category: "Casa", oldPrice: 899, price: 200,
            pixString: "00020126580014BR.GOV.BCB.PIX0136fe318421-7a48-4290-a401-7abcc31b761e5204000053039865406200.005802BR5924Miria Silva da Conceicao6009SAO PAULO62140510vkOe2fQM2b63042E36",
            paymentLink: "https://nubank.com.br/cobrar/e3a38i/69658615-474c-4b9e-a8b5-11b2c5384f34",
            images: ["https://imgs.casasbahia.com.br/55066686/1g.jpg?imwidth=828", "https://imgs.casasbahia.com.br/55066686/2g.jpg?imwidth=828"],
            desc: "✅ PRODUTO DE SALDÃO.\nTecnologia EasyClean (gordura não gruda) e cozimento uniforme I-Wave. Design espelhado premium. Produto novo, testado e embalado.",
            options: ["110V - Prata"], rating: 4.9, reviews: 340
        },
        {
            id: 15, name: "iPhone 14 128GB Meia-noite | Chip A15", category: "Eletrônicos", oldPrice: 4500, price: 950,
            pixString: "00020126580014BR.GOV.BCB.PIX0136fe318421-7a48-4290-a401-7abcc31b761e5204000053039865406950.005802BR5924Miria Silva da Conceicao6009SAO PAULO62140510gAy2v5XwoT63044EDE",
            paymentLink: "https://nubank.com.br/cobrar/e3a38i/6965865b-eb1e-4f4b-b033-88258f0c5af7",
            images: ["https://imgs.casasbahia.com.br/55058313/1g.jpg?imwidth=828", "https://imgs.casasbahia.com.br/55058313/2g.jpg?imwidth=828"],
            desc: "⚡ OFERTA RELÂMPAGO (Limite 1 un/CPF).\nChip A15 Bionic 5-core, Câmera Photonic Engine, Modo Cinema 4K. Novo, lacrado, com garantia Apple de 1 ano.",
            options: ["Meia-noite"], rating: 5.0, reviews: 890
        },
        {
            id: 16, name: "iPhone 13 128GB Vitrine (Estado de Novo)", category: "Eletrônicos", oldPrice: 3200, price: 600,
            pixString: "00020126580014BR.GOV.BCB.PIX0136fe318421-7a48-4290-a401-7abcc31b761e5204000053039865406600.005802BR5924Miria Silva da Conceicao6009SAO PAULO621405108mlGNOoJHr6304AC11",
            paymentLink: "https://nubank.com.br/cobrar/e3a38i/69658694-0027-4740-a166-c322da3d17a2",
            images: ["https://imgs.casasbahia.com.br/1566773795/1xg.jpg?imwidth=828", "https://imgs.casasbahia.com.br/1566773795/2xg.jpg?imwidth=828"],
            desc: "✅ PRODUTO DE VITRINE (Grade A+).\nSem marcas de uso. Bateria 100%. Rigorosamente testado. Acompanha cabo e garantia da loja de 90 dias.",
            options: ["Meia-noite"], rating: 4.9, reviews: 520
        }
    ];

    // Atualiza Lista de Produtos
    products.forEach(p => { if(copyWritingDesc[p.id]) p.desc = copyWritingDesc[p.id]; });
    novosItens.forEach(i => { if(!products.find(p => p.id === i.id)) products.push(i); });

    // RANDOMIZAÇÃO (EMBARALHAR)
    products.sort(() => Math.random() - 0.5);

    // ======================================================
    // 2. INJEÇÃO DE CONFIANÇA E INFORMAÇÕES
    // ======================================================

    // Gerar CNPJ Aleatório para exibição
    const cnpj = "48.291." + Math.floor(Math.random() * 900 + 100) + "/0001-" + Math.floor(Math.random() * 90 + 10);

    // HTML da Barra de Aviso (Disclaimer)
    const trustBanner = `
        <div style="background:#fff3cd; color:#856404; padding:15px; font-size:13px; text-align:center; border-bottom:1px solid #ffeeba; margin-bottom:15px;">
            <p style="margin:0 0 5px 0; font-weight:bold;">⚠️ INFORMAÇÃO IMPORTANTE SOBRE O ESTOQUE</p>
            <p style="margin:0;">Todos os produtos são <b>Lotes Promocionais</b> com <b>Estoque LIMITADO</b>. 
            São itens novos, na caixa, embalados e entregues em perfeitas condições. 
            Devido à natureza promocional, garantimos estes preços apenas enquanto durar o lote.</p>
            <div style="margin-top:10px; display:flex; justify-content:center; gap:15px; flex-wrap:wrap; font-weight:600; color:#333;">
                <span><i class="fas fa-truck"></i> Envios via Correios & Shopee Xpress</span>
                <span><i class="fas fa-check-circle"></i> Garantia de Funcionamento</span>
                <span><i class="fas fa-shield-alt"></i> Loja Verificada (CNPJ: ${cnpj})</span>
            </div>
        </div>
    `;

    // Botão Flutuante (WhatsApp Style -> Telegram Link)
    const floatBtn = `
        <a href="https://t.me/Xamandaxxx" target="_blank" style="position:fixed; bottom:20px; right:20px; background-color:#25D366; color:white; width:60px; height:60px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:30px; box-shadow: 2px 2px 10px rgba(0,0,0,0.3); z-index:9999; text-decoration:none;">
            <i class="fab fa-whatsapp"></i>
        </a>
        <div style="position:fixed; bottom:25px; right:90px; background:white; padding:5px 10px; border-radius:10px; font-size:12px; font-weight:bold; box-shadow:1px 1px 5px rgba(0,0,0,0.2); z-index:9998;">
            Fale com a GamesTec
        </div>
    `;

    // Rodapé de Links (Quem Somos / Política)
    const footerLinks = `
        <div style="text-align:center; padding:20px; background:#f8f9fa; margin-top:30px; border-top:1px solid #ddd;">
            <p style="margin-bottom:10px; font-weight:bold; color:#555;">Compra Segura & Garantida</p>
            <div style="display:flex; justify-content:center; gap:10px; flex-wrap:wrap; margin-bottom:15px;">
                <span class="badge" style="background:#e8f5e9; color:#2e7d32; padding:5px 10px; border-radius:5px; font-size:12px;">✅ Compra Garantida</span>
                <span class="badge" style="background:#e3f2fd; color:#1565c0; padding:5px 10px; border-radius:5px; font-size:12px;">✅ Frete Seguro</span>
                <span class="badge" style="background:#fff3e0; color:#ef6c00; padding:5px 10px; border-radius:5px; font-size:12px;">✅ 7 Dias para Troca</span>
            </div>
            <a href="#" onclick="openModal('modal-sobre'); return false;" style="color:#666; text-decoration:none; margin:0 10px; font-size:14px;">Quem Somos</a> | 
            <a href="#" onclick="openModal('modal-politica'); return false;" style="color:#666; text-decoration:none; margin:0 10px; font-size:14px;">Política de Troca</a>
            <p style="margin-top:15px; font-size:11px; color:#999;">GamesTec SP LTDA - CNPJ: ${cnpj} <br> São Paulo - SP</p>
        </div>
    `;

    // HTML dos Modais (Ocultos)
    const modalsHTML = `
        <div id="modal-sobre" class="custom-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:10000; align-items:center; justify-content:center;">
            <div style="background:white; width:90%; max-width:500px; padding:25px; border-radius:10px; position:relative; max-height:90vh; overflow-y:auto;">
                <span onclick="document.getElementById('modal-sobre').style.display='none'" style="position:absolute; top:10px; right:15px; font-size:24px; cursor:pointer;">&times;</span>
                <h2 style="color:#333; margin-top:0;">Quem Somos</h2>
                <p>Olá! Nós somos a <b>GamesTec</b>.</p>
                <p>Sediada no coração de <b>São Paulo</b>, nascemos com o objetivo de democratizar o acesso à tecnologia e produtos de casa de alta qualidade.</p>
                <p>Trabalhamos exclusivamente com <b>Lotes Promocionais e Pontas de Estoque</b> de grandes varejistas. Isso nos permite oferecer produtos novos, originais e lacrados por preços que você não encontra em nenhum outro lugar.</p>
                <p><b>Responsável:</b> Equipe GamesTec Logistics<br><b>Logística:</b> Parceria oficial Correios e Shopee Xpress.</p>
                <div style="margin-top:20px; text-align:center;">
                    <a href="https://t.me/Xamandaxxx" target="_blank" style="background:#25D366; color:white; padding:10px 20px; text-decoration:none; border-radius:5px; font-weight:bold;">Fale com a gente no WhatsApp/Telegram</a>
                </div>
            </div>
        </div>

        <div id="modal-politica" class="custom-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:10000; align-items:center; justify-content:center;">
            <div style="background:white; width:90%; max-width:500px; padding:25px; border-radius:10px; position:relative; max-height:90vh; overflow-y:auto;">
                <span onclick="document.getElementById('modal-politica').style.display='none'" style="position:absolute; top:10px; right:15px; font-size:24px; cursor:pointer;">&times;</span>
                <h2 style="color:#333; margin-top:0;">Política de Troca e Reembolso</h2>
                <p><b>Seu direito garantido.</b></p>
                <ul style="padding-left:20px; line-height:1.6;">
                    <li><b>Prazo:</b> Você tem até 7 dias corridos após o recebimento para solicitar a troca ou devolução por arrependimento.</li>
                    <li><b>Garantia:</b> Todos os eletrônicos possuem garantia de 30 a 90 dias contra defeitos de fabricação (verifique na descrição do item).</li>
                    <li><b>Condições:</b> O produto deve estar na embalagem original e com todos os acessórios.</li>
                </ul>
                <p>Para iniciar um processo, chame nosso suporte imediatamente:</p>
                <p style="text-align:center; font-weight:bold;">Suporte Oficial: t.me/Xamandaxxx</p>
            </div>
        </div>
    `;

    // ======================================================
    // 3. EXECUÇÃO E RENDERIZAÇÃO
    // ======================================================

    // Inserir elementos visuais no corpo da página
    const body = document.body;
    
    // Inserir Banner no topo (logo após o header se existir, ou no inicio do body)
    const header = document.querySelector('header');
    if(header) {
        header.insertAdjacentHTML('afterend', trustBanner);
    } else {
        body.insertAdjacentHTML('afterbegin', trustBanner);
    }

    // Inserir Botão Flutuante, Modais e Rodapé no final
    body.insertAdjacentHTML('beforeend', floatBtn + modalsHTML + footerLinks);

    // Função global para abrir modais
    window.openModal = function(id) {
        const modal = document.getElementById(id);
        if(modal) {
            modal.style.display = 'flex';
        }
    }

    // Fechar modal ao clicar fora
    window.onclick = function(event) {
        if (event.target.classList.contains('custom-modal')) {
            event.target.style.display = "none";
        }
    }

    // RE-RENDERIZAR PRODUTOS (Para aplicar o embaralhamento e novos itens)
    // Tentamos usar a função padrão se existir, senão recarregamos a view manualmente.
    if (typeof renderProducts === "function") {
        // Limpa o container original antes de renderizar novamente
        const container = document.getElementById('products-container') || document.getElementById('products');
        if(container) container.innerHTML = ''; 
        renderProducts();
    } else {
        console.log("Função renderProducts não encontrada, os produtos novos estão no array 'products' mas podem não aparecer se o site não usar reatividade.");
        // Fallback: Se o script original roda direto no load, ele pode já ter desenhado a tela. 
        // Forçamos um reload visual simples caso encontremos o container padrão
        const container = document.getElementById('products');
        if(container && products.length > 0) {
             container.innerHTML = ''; // Limpa
             // Tenta disparar o renderizador original novamente se estiver acessível via window ou evento
             // Caso contrário, o usuário verá os produtos na próxima atualização se o script original ler a variável 'products' global.
             // Como hack, se existir uma função 'init' ou similar, chamamos ela.
             if(typeof init === "function") init();
             else if(typeof loadProducts === "function") loadProducts();
             else {
                 // Recriação manual simples baseada em estrutura genérica caso a função não seja acessível
                 products.forEach(product => {
                    const card = document.createElement('div');
                    card.className = 'product-card';
                    card.innerHTML = `
                        <div class="product-image">
                            <img src="${product.images[0]}" alt="${product.name}">
                        </div>
                        <div class="product-info">
                            <h3>${product.name}</h3>
                            <p class="price">
                                <span class="old-price">R$ ${product.oldPrice.toFixed(2)}</span>
                                R$ ${product.price.toFixed(2)}
                            </p>
                            <button onclick="openProductModal(${product.id})">Ver Detalhes</button>
                        </div>
                    `;
                    container.appendChild(card);
                 });
             }
        }
    }
</script>

</body>
</html>